<!DOCTYPE html><html lang="en-gb"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
  <meta name="theme-color" content="#F5D76E">
  <meta http-equiv="Referrer-Policy" content="same-origin">
  <title>mail.cazehiresense.com - mail UI</title>

  <link rel="stylesheet" href="/cache/0b3522a3bf0d3f5a8e16a19eb97cce9c66a644b9.css">
  <script>
    // check if darkmode is preferred by OS or set by localStorage
    if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches && localStorage.getItem("theme") !== "light" ||
        localStorage.getItem("theme") === "dark") {
      var head  = document.getElementsByTagName('head')[0];
      var link  = document.createElement('link');
      link.id   = 'dark-mode-theme';
      link.rel  = 'stylesheet';
      link.type = 'text/css';
      link.href = '/css/themes/mailcow-darkmode.css';
      head.appendChild(link);
    }
  </script>

  <link rel="shortcut icon" href="/favicon.png" type="image/png">
  <link rel="icon" href="/favicon.png" type="image/png">
</head>
<body>
<div class="overlay" style="display: none;"></div>
<nav class="navbar navbar-expand-lg navbar-light bg-light sticky-top p-0">
  <div class="container-fluid">
    <a class="navbar-brand" href="/">
      <img class="main-logo" alt="mailcow-logo" src="/img/cow_mailcow.svg">
      <img class="main-logo-dark d-none" alt="mailcow-logo-dark" src="/img/cow_mailcow.svg">
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <i class="bi bi-list fs-3"></i>
    </button>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="navbar-nav ms-auto">
        <li class="nav-item">
          <div class="nav-link form-check form-switch my-auto d-flex align-items-center">
            <label class="form-check-label"><i class="bi bi-moon-fill"></i></label>
            <input class="form-check-input ms-2" type="checkbox" id="dark-mode-toggle">
          </div>
        </li>
                <li class="nav-item dropdown">
          <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false"><span class="flag-icon flag-icon-gb"></span></a>
          <ul class="dropdown-menu" role="menu " aria-labelledby="languageDropdown">
                        <li>
              <a class="dropdown-item " href="?lang=bg-bg">
                <span class="flag-icon flag-icon-bg"></span>Български (Bulgarian)
              </a>
            </li>
                        <li>
              <a class="dropdown-item " href="?lang=cs-cz">
                <span class="flag-icon flag-icon-cz"></span>Čeština (Czech)
              </a>
            </li>
                        <li>
              <a class="dropdown-item " href="?lang=da-dk">
                <span class="flag-icon flag-icon-dk"></span>Dansk (Danish)
              </a>
            </li>
                        <li>
              <a class="dropdown-item " href="?lang=de-de">
                <span class="flag-icon flag-icon-de"></span>Deutsch (German)
              </a>
            </li>
                        <li>
              <a class="dropdown-item active" href="?lang=en-gb">
                <span class="flag-icon flag-icon-gb"></span>English
              </a>
            </li>
                        <li>
              <a class="dropdown-item " href="?lang=es-es">
                <span class="flag-icon flag-icon-es"></span>Español (Spanish)
              </a>
            </li>
                        <li>
              <a class="dropdown-item " href="?lang=fi-fi">
                <span class="flag-icon flag-icon-fi"></span>Suomi (Finish)
              </a>
            </li>
                        <li>
              <a class="dropdown-item " href="?lang=fr-fr">
                <span class="flag-icon flag-icon-fr"></span>Français (French)
              </a>
            </li>
                        <li>
              <a class="dropdown-item " href="?lang=gr-gr">
                <span class="flag-icon flag-icon-gr"></span>Ελληνικά (Greek)
              </a>
            </li>
                        <li>
              <a class="dropdown-item " href="?lang=hu-hu">
                <span class="flag-icon flag-icon-hu"></span>Magyar (Hungarian)
              </a>
            </li>
                        <li>
              <a class="dropdown-item " href="?lang=it-it">
                <span class="flag-icon flag-icon-it"></span>Italiano (Italian)
              </a>
            </li>
                        <li>
              <a class="dropdown-item " href="?lang=ja-jp">
                <span class="flag-icon flag-icon-jp"></span>日本語 (Japanese)
              </a>
            </li>
                        <li>
              <a class="dropdown-item " href="?lang=ko-kr">
                <span class="flag-icon flag-icon-kr"></span>한국어 (Korean)
              </a>
            </li>
                        <li>
              <a class="dropdown-item " href="?lang=lv-lv">
                <span class="flag-icon flag-icon-lv"></span>latviešu (Latvian)
              </a>
            </li>
                        <li>
              <a class="dropdown-item " href="?lang=lt-lt">
                <span class="flag-icon flag-icon-lt"></span>Lietuvių (Lithuanian)
              </a>
            </li>
                        <li>
              <a class="dropdown-item " href="?lang=nb-no">
                <span class="flag-icon flag-icon-no"></span>Norsk (Norwegian)
              </a>
            </li>
                        <li>
              <a class="dropdown-item " href="?lang=nl-nl">
                <span class="flag-icon flag-icon-nl"></span>Nederlands (Dutch)
              </a>
            </li>
                        <li>
              <a class="dropdown-item " href="?lang=pl-pl">
                <span class="flag-icon flag-icon-pl"></span>Język Polski (Polish)
              </a>
            </li>
                        <li>
              <a class="dropdown-item " href="?lang=pt-br">
                <span class="flag-icon flag-icon-br"></span>Português brasileiro (Brazilian Portuguese)
              </a>
            </li>
                        <li>
              <a class="dropdown-item " href="?lang=pt-pt">
                <span class="flag-icon flag-icon-pt"></span>Português (Portuguese)
              </a>
            </li>
                        <li>
              <a class="dropdown-item " href="?lang=ro-ro">
                <span class="flag-icon flag-icon-ro"></span>Română (Romanian)
              </a>
            </li>
                        <li>
              <a class="dropdown-item " href="?lang=ru-ru">
                <span class="flag-icon flag-icon-ru"></span>Pусский (Russian)
              </a>
            </li>
                        <li>
              <a class="dropdown-item " href="?lang=si-si">
                <span class="flag-icon flag-icon-si"></span>Slovenščina (Slovenian)
              </a>
            </li>
                        <li>
              <a class="dropdown-item " href="?lang=sk-sk">
                <span class="flag-icon flag-icon-sk"></span>Slovenčina (Slovak)
              </a>
            </li>
                        <li>
              <a class="dropdown-item " href="?lang=sv-se">
                <span class="flag-icon flag-icon-se"></span>Svenska (Swedish)
              </a>
            </li>
                        <li>
              <a class="dropdown-item " href="?lang=tr-tr">
                <span class="flag-icon flag-icon-tr"></span>Türkçe (Turkish)
              </a>
            </li>
                        <li>
              <a class="dropdown-item " href="?lang=uk-ua">
                <span class="flag-icon flag-icon-ua"></span>Українська (Ukrainian)
              </a>
            </li>
                        <li>
              <a class="dropdown-item " href="?lang=vi-vn">
                <span class="flag-icon flag-icon-vn"></span>Tiếng Việt (Vietnamese)
              </a>
            </li>
                        <li>
              <a class="dropdown-item " href="?lang=zh-cn">
                <span class="flag-icon flag-icon-cn"></span>简体中文 (Simplified Chinese)
              </a>
            </li>
                        <li>
              <a class="dropdown-item " href="?lang=zh-tw">
                <span class="flag-icon flag-icon-tw"></span>繁體中文 (Traditional Chinese)
              </a>
            </li>
                      </ul>
        </li>
        
                                <li class="nav-item dropdown">
          <a href="/user" class="nav-link" role="button" aria-expanded="false">User Settings</a>
        </li>
        
        
                <li class="nav-item dropdown">
          <a href="/quarantine" class="nav-link">Quarantine</a>
        </li>
                
                <li class="nav-item dropdown">
          <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false"><i class="bi bi-link-45deg me-2"></i> Apps</a>
          <ul class="dropdown-menu">
                                        <li>
                <a href="/SOGo/so" class="dropdown-item">Webmail</a>
              </li>
                                                </ul>
        </li>
                        <li class="logged-in-as nav-item"><a href="#" onclick="logout.submit()" class="nav-link"><b class="username-lia">hsd2loon9@cazehiresense.com</b> <i class="bi bi-power ms-2"></i></a></li>
                      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container-fluid -->
</nav>

<form action="/" method="post" id="logout"><input type="hidden" name="logout"><input type="hidden" value="a5e6f51085b6fcb8adc07084305e3956154d5683abdb5f23eb17f4a1dc5844df" name="csrf_token"></form>


<div class="container flex-grow-1 my-4">
<div id="user-content" class="responsive-tabs">
  <!-- Nav tabs -->
  <ul class="nav nav-tabs" role="tablist">
    <li class="nav-item dropdown" role="presentation">
      <a class="nav-link dropdown-toggle active" data-bs-toggle="dropdown" href="#" role="button" aria-expanded="false">Mailbox</a>
      <ul class="dropdown-menu">
        <li><button class="dropdown-item active" role="tab" aria-selected="true" aria-controls="tab-user-auth" data-bs-toggle="tab" data-bs-target="#tab-user-auth">General</button></li>
        <li><button class="dropdown-item" role="tab" aria-selected="false" aria-controls="tab-config-fwdhosts" data-bs-toggle="tab" data-bs-target="#tab-user-details">Details</button></li>
        <li><button class="dropdown-item" role="tab" aria-selected="false" aria-controls="tab-config-f2b" data-bs-toggle="tab" data-bs-target="#tab-user-settings">Settings</button></li>
      </ul>
    </li>
        <li class="nav-item" role="presentation"><button class="nav-link" role="tab" aria-selected="false" aria-controls="SpamAliases" data-bs-toggle="tab" data-bs-target="#SpamAliases">Spam email aliases</button></li>
            <li class="nav-item" role="presentation"><button class="nav-link" role="tab" aria-selected="false" aria-controls="Spamfilter" data-bs-toggle="tab" data-bs-target="#Spamfilter">Spam filter</button></li>
                <li class="nav-item" role="presentation"><button class="nav-link" role="tab" aria-selected="false" aria-controls="AppPasswds" data-bs-toggle="tab" data-bs-target="#AppPasswds">App passwords</button></li>
            <li class="nav-item" role="presentation"><button class="nav-link" role="tab" aria-selected="false" aria-controls="Pushover" data-bs-toggle="tab" data-bs-target="#Pushover">Pushover API</button></li>
      </ul>

  <div class="row">
    <div class="col-md-12">
      <div class="tab-content" style="padding-top:20px">
        <div class="tab-pane fade in active show" id="tab-user-auth" role="tabpanel" aria-labelledby="tab-user-auth">
  <div class="card mb-4">
    <div class="card-header d-flex fs-5">
      <button class="btn d-md-none flex-grow-1 text-start" data-bs-target="#collapse-tab-user-auth" data-bs-toggle="collapse" aria-controls="collapse-tab-user-auth">
        General
      </button>
      <span class="d-none d-md-block">General</span>
    </div>
    <div id="collapse-tab-user-auth" class="card-body collapse" data-bs-parent="#user-content">
            <div class="row">
        <div class="col-xl-9 col-lg-7 col-md-12 col-12 d-flex flex-column mb-4">
                    <div class="row mb-4">
            <div class="col-12 col-lg-6 col-xl-4">
                              <a href="/SOGo/so" role="button" class="btn btn-primary btn-lg btn-block btn-xs-lg w-100">
                  Webmail <i class="bi bi-arrow-right"></i>
                </a>
                          </div>
          </div>
          
          <legend>Overview</legend>
          <hr>
          <div class="d-flex">
            <h5><i class="bi bi-envelope-fill"></i> 1 messages</h5>
            <h5 class="ms-auto">1.96 KiB / ∞</h5>
          </div>
          <div class="progress mb-4" style="height: 20px" ;="">
            <div class="progress-bar bg-info" role="progressbar" aria-valuenow="- " aria-valuemin="0" aria-valuemax="100" style="min-width:2em;width: - %;">
              - %
            </div>
          </div>

          <div class="row">
            <div class="col-12 col-md-3 d-flex">
              <span class="mt-2 w-100 text-md-end">Protocols:</span>
            </div>
            <div class="col-12 col-md-9 d-flex">
              <i style="font-size: 16px; cursor: pointer;" class="bi bi-patch-question-fill m-2 ms-0" data-bs-toggle="tooltip" data-bs-html="true" data-bs-placement="bottom" title="" webmail"="" button="" provides="" single-sign-on="" to="" sogo="" and="" is="" always="" available."="" data-bs-original-title="This mailbox user has &lt;b&gt;direct, external access&lt;/b&gt; to the following protocols and applications. This setting is controlled by your administrator. App passwords can be created to grant access to individual protocols and applications.&lt;br&gt;The " aria-label="This mailbox user has &lt;b&gt;direct, external access&lt;/b&gt; to the following protocols and applications. This setting is controlled by your administrator. App passwords can be created to grant access to individual protocols and applications.&lt;br&gt;The "></i>
              <div class="d-flex flex-wrap">
              <div class="badge fs-6 bg-success m-2">IMAP <i class="bi bi-check-lg"></i></div>              <div class="badge fs-6 bg-success m-2">SMTP <i class="bi bi-check-lg"></i></div>              <div class="badge fs-6 bg-success m-2">Sieve <i class="bi bi-check-lg"></i></div>              <div class="badge fs-6 bg-success m-2">POP3 <i class="bi bi-check-lg"></i></div>              </div>
            </div>
          </div>
          <div class="row mt-2">
            <div class="col-12 col-md-3 d-flex">
              <span class="mt-2 w-100 text-md-end">Apple connection profile:</span>
            </div>
            <div class="col-12 col-md-8">
              <div class="d-flex">
                <i style="font-size: 16px; cursor: pointer;" class="bi bi-patch-question-fill me-2" data-bs-toggle="tooltip" data-bs-html="true" data-bs-placement="bottom" title="" data-bs-original-title="This connection profile includes IMAP and SMTP configuration parameters for an Apple device." aria-label="This connection profile includes IMAP and SMTP configuration parameters for an Apple device."></i>
                <a href="/mobileconfig.php?only_email">Email <small>[IMAP, SMTP]</small></a>
              </div>
                            <div class="d-flex">
                <i style="font-size: 16px; cursor: pointer;" class="bi bi-patch-question-fill me-2" data-bs-toggle="tooltip" data-bs-html="true" data-bs-placement="bottom" title="" data-bs-original-title="This connection profile includes IMAP and SMTP parameters as well as CalDAV (calendars) and CardDAV (contacts) paths for an Apple device." aria-label="This connection profile includes IMAP and SMTP parameters as well as CalDAV (calendars) and CardDAV (contacts) paths for an Apple device."></i>
                <a href="/mobileconfig.php">Email, calendars and contacts <small>[IMAP, SMTP, Cal/CardDAV]</small></a>
              </div>
                          </div>
          </div>
          <div class="row mt-2">
            <div class="col-12 col-md-3 d-flex">
              <span class="mt-2 w-100 text-md-end">Apple connection profile<br>with app password:</span>
            </div>
            <div class="col-12 col-md-9">
              <div class="d-flex">
                <i style="font-size: 16px; cursor: pointer;" class="bi bi-patch-question-fill me-2" data-bs-toggle="tooltip" data-bs-html="true" data-bs-placement="bottom" title="" data-bs-original-title="This connection profile includes IMAP and SMTP configuration parameters for an Apple device. A new app password is generated and added to the profile so that no password needs to be entered when setting up your device. Please do not share the file as it grants full access to your mailbox." aria-label="This connection profile includes IMAP and SMTP configuration parameters for an Apple device. A new app password is generated and added to the profile so that no password needs to be entered when setting up your device. Please do not share the file as it grants full access to your mailbox."></i>
                <a href="/mobileconfig.php?only_email&amp;app_password">Email <small>[IMAP, SMTP]</small></a>
              </div>
                            <div class="d-flex">
                <i style="font-size: 16px; cursor: pointer;" class="bi bi-patch-question-fill me-2" data-bs-toggle="tooltip" data-bs-html="true" data-bs-placement="bottom" title="" data-bs-original-title="This connection profile includes IMAP and SMTP parameters as well as CalDAV (calendars) and CardDAV (contacts) paths for an Apple device. A new app password is generated and added to the profile so that no password needs to be entered when setting up your device. Please do not share the file as it grants full access to your mailbox." aria-label="This connection profile includes IMAP and SMTP parameters as well as CalDAV (calendars) and CardDAV (contacts) paths for an Apple device. A new app password is generated and added to the profile so that no password needs to be entered when setting up your device. Please do not share the file as it grants full access to your mailbox."></i>
                <a href="/mobileconfig.php?app_password">Email, calendars and contacts <small>[IMAP, SMTP, Cal/CardDAV]</small></a>
              </div>
                          </div>
          </div>
          <div class="row">
            <div class="col-12 d-flex flex-column text-center align-items-center mt-4">
              <a target="_blank" href="https://mailcow.github.io/mailcow-dockerized-docs/client/client/#host=mail.cazehiresense.com&amp;email=hsd2loon9%40cazehiresense.com&amp;name=User+154&amp;ui=mail.cazehiresense.com&amp;port=443">Show configuration guides for email clients and smartphones</a>
              <a class="mt-2" href="#userFilterModal" data-bs-toggle="modal">Show active user sieve filter</a>
            </div>
          </div>

                    <legend class="mt-4">Authentication</legend>
          <hr>
                    <div class="row">
            <div class="col-12 col-md-3 d-flex"></div>
            <div class="col-12 col-md-9 d-flex flex-wrap">
              <a class="btn btn-secondary" href="#pwChangeModal" data-bs-toggle="modal"><i class="bi bi-pencil-fill"></i> Change password</a>
                          </div>
          </div>
                                        <div class="row mt-4">
            <div class="col-12 col-md-3 d-flex">
              <span class="mt-2 w-100 text-md-end">Two-factor authentication:</span>
            </div>
            <div class="col-12 col-md-9 d-flex flex-wrap justify-content-center justify-content-sm-start">
              <span id="tfa_pretty">-</span>
              <div id="tfa_keys">
  </div>
            </div>
          </div>
          <div class="row mt-2 mb-4">
            <div class="col-12 col-md-3 d-flex">
              <span class="mt-2 w-100 text-md-end">Set two-factor authentication method:</span>
            </div>
            <div class="col-12 col-md-9 d-flex flex-wrap align-items-center justify-content-center justify-content-sm-start">
              <i style="font-size: 16px; cursor: pointer;" class="bi bi-patch-question-fill m-2 ms-0" data-bs-toggle="tooltip" data-bs-html="true" data-bs-placement="bottom" title="" data-bs-original-title="Two-factor authentication helps protect your account. If you enable it, you need app passwords to log in to apps or services that don't support two-factor authentication (e.g. Mailclients)." aria-label="Two-factor authentication helps protect your account. If you enable it, you need app passwords to log in to apps or services that don't support two-factor authentication (e.g. Mailclients)."></i>
              <div class="dropdown bootstrap-select fit-width"><select data-style="ms-2 btn btn-sm dropdown-toggle bs-placeholder btn-secondary" data-width="fit" id="selectTFA" class="selectpicker" title="Please select"><option class="bs-title-option" value=""></option>
                <option value="yubi_otp">Yubico OTP authentication</option>
                <option value="webauthn">WebAuthn authentication</option>
                <option value="totp">Time-based OTP (Google Authenticator, Authy, etc.)</option>
                <option value="none">Deactivate</option>
              </select><button type="button" tabindex="-1" class="ms-2 btn btn-sm dropdown-toggle bs-placeholder btn-secondary" data-bs-toggle="dropdown" role="combobox" aria-owns="bs-select-1" aria-haspopup="listbox" aria-expanded="false" title="Please select" data-id="selectTFA"><div class="filter-option"><div class="filter-option-inner"><div class="filter-option-inner-inner">Please select</div></div> </div></button><div class="dropdown-menu "><div class="inner show" role="listbox" id="bs-select-1" tabindex="-1"><ul class="dropdown-menu inner show" role="presentation"></ul></div></div></div>
            </div>
          </div>
                                        <div class="row mt-4">
            <div class="col-sm-3 col-12 text-sm-end text-start">
              <p><i class="bi bi-shield-fill-check"></i> Login with FIDO2</p>
            </div>
          </div>
          <div class="row">
            <div class="col-sm-3 col-12 text-sm-end text-start mb-4">
              Known IDs:
            </div>
            <div class="col-sm-9 col-12">
              <div class="table-responsive">
                <table class="table table-striped table-hover table-condensed" id="fido2_keys">
                  <tbody><tr>
                    <th>ID</th>
                    <th style="min-width:240px;text-align: right">Action</th>
                  </tr>
                                  </tbody></table>
              </div>
              <br>
            </div>
          </div>
          <div class="row">
            <div class="offset-sm-3 col-sm-9">
              <div class="btn-group nowrap">
                <button class="btn btn-sm btn-primary d-block d-sm-inline" id="register-fido2">Register FIDO2 device</button>
                <button type="button" class="btn btn-sm btn-xs-lg btn-primary dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"></button>
                <ul class="dropdown-menu">
                  <li><a class="dropdown-item" href="#" id="register-fido2-touchid"><i class="bi bi-apple"></i> Register Touch ID on Apple M1</a></li>
                </ul>
              </div>
            </div>
          </div>
          <br>
          <div class="row" id="status-fido2">
            <div class="col-sm-3 col-5 text-end">Registration status:</div>
            <div class="col-sm-9 col-7">
              <div id="fido2-alerts">-</div>
            </div>
            <br>
          </div>
                  </div>
        <div class="ms-auto col-xl-3 col-lg-5 col-md-12 col-12 d-flex flex-column well flex-grow-1" id="recent-logins">
          <legend class="d-flex">
            <span>Seen successful connections</span>
            <div id="spinner-last-login" class="ms-auto my-auto spinner-border spinner-border-sm d-none" role="status">
              <span class="visually-hidden">Loading...</span>
            </div>
          </legend>
          <hr>
          <div class="d-flex">
            <span class="clear-last-logins mt-auto mb-2">
              Clear seen successful connections
            </span>
            <div class="dropdown mt-4 mb-2 ms-auto">
              <button class="btn btn-secondary btn-xs btn-xs-lg dropdown-toggle" type="button" id="history_sasl_days" data-bs-toggle="dropdown">Login history</button>
              <ul class="dropdown-menu">
                <li class="login-history" data-days="1"><a class="dropdown-item" href="#">1 day</a></li>
                <li class="login-history" data-days="7"><a class="dropdown-item active" href="#">1 week</a></li>
                <li class="login-history" data-days="14"><a class="dropdown-item" href="#">2 weeks</a></li>
                <li class="login-history" data-days="31"><a class="dropdown-item" href="#">1 month</a></li>
              </ul>
            </div>
          </div>
          <ul class="list-group last-sasl-login overflow-auto" style="flex: 1 1 0; min-height: 400px;"><ul class="list-group"></ul>
                <li class="list-group-item d-flex justify-content-between align-items-start">
                  <div class="ms-2 me-auto d-flex flex-column">
                    <div class="fw-bold"> <span class="flag-icon flag-icon-in"></span><a href="https://bgp.tools/prefix/103.161.55.31" target="_blank">103.161.55.31</a></div>
                    <small class="fst-italic mt-2"><div class="badge bg-secondary">MAILCOWUI</div> 29/01/2026, 00:34:36</small>
                  </div>
                </li>
              
                <li class="list-group-item d-flex justify-content-between align-items-start">
                  <div class="ms-2 me-auto d-flex flex-column">
                    <div class="fw-bold">Web/EAS/Internal (172.22.1.248)</div>
                    <small class="fst-italic mt-2"><div class="badge bg-secondary">SOGO</div> 29/01/2026, 00:33:52</small>
                  </div>
                </li>
              </ul>
        </div>
      </div>
    </div>
  </div>
</div>
        <div class="tab-pane fade" id="tab-user-details" role="tabpanel" aria-labelledby="tab-user-details">
  <div class="card mb-4">
    <div class="card-header d-flex fs-5">
      <button class="btn d-md-none flex-grow-1 text-start" data-bs-target="#collapse-tab-user-details" data-bs-toggle="collapse" aria-controls="collapse-tab-user-details">
        Details
      </button>
      <span class="d-none d-md-block">Details</span>
    </div>
    <div id="collapse-tab-user-details" class="card-body collapse" data-bs-parent="#user-content">
      <div class="row">
        <div class="col-sm-4 col-md-3 col-12 text-sm-end text-start"><i class="bi bi-pin-angle"></i> Direct alias addresses:
          <p class="small">Direct alias addresses are affected by spam filter and TLS policy settings.</p>
        </div>
        <div class="col-sm-8 col-md-9 col-12">
                     <i class="bi bi-x-lg"></i>
                  </div>
      </div>
      <br>
      <div class="row">
        <div class="col-sm-4 col-md-3 col-12 text-sm-end text-start"><i class="bi bi-share"></i> Shared alias addresses:
          <p class="small">Shared aliases are not affected by user specific settings such as the spam filter or encryption policy. Corresponding spam filters can only be made by an administrator as a domain-wide policy.</p>
        </div>
        <div class="col-sm-8 col-md-9 col-12">
                      <i class="bi bi-x-lg"></i>
                  </div>
      </div>
      <hr>
      <div class="row">
        <div class="col-sm-4 col-md-3 col-12 text-sm-end text-start mb-4">Also allowed to send as user:</div>
        <div class="col-sm-8 col-md-9 col-12">
          <p>
                          <i class="bi bi-x-lg"></i>
                      </p>
        </div>
      </div>
      <div class="row">
        <div class="col-sm-4 col-md-3 col-12 text-sm-end text-start mb-4">Do not check sender access for the following domain(s) and its alias domains:</div>
        <div class="col-sm-8 col-md-9 col-12">
          <p><i class="bi bi-x-lg"></i></p>
        </div>
      </div>
      <div class="row">
        <div class="col-sm-4 col-md-3 col-12 text-sm-end text-start mb-4">Catch-all for domain/s:</div>
        <div class="col-sm-8 col-md-9 col-12">
          <p><i class="bi bi-x-lg"></i></p>
        </div>
      </div>
    </div>
  </div>
</div>
        <div class="tab-pane fade" id="tab-user-settings" role="tabpanel" aria-labelledby="tab-user-settings">
  <div class="card mb-4">
    <div class="card-header d-flex fs-5">
      <button class="btn d-md-none flex-grow-1 text-start" data-bs-target="#collapse-tab-user-settings" data-bs-toggle="collapse" aria-controls="collapse-tab-user-settings">
        Settings
      </button>
      <span class="d-none d-md-block">Settings</span>
    </div>
    <div id="collapse-tab-user-settings" class="card-body collapse" data-bs-parent="#user-content">
            <div class="row">
        <div class="col-sm-3 col-12 text-sm-end text-start text-xs-bold mb-4">Set handling for tagged mail:</div>
        <div class="col-sm-9 col-12">
          <div class="btn-group" data-acl="1">
            <button type="button" class="btn btn-sm btn-xs-third d-block d-sm-inline btn-light" data-action="edit_selected" data-item="hsd2loon9@cazehiresense.com" data-id="delimiter_action" data-api-url="edit/delimiter_action" data-api-attr="{&quot;tagged_mail_handler&quot;:&quot;subfolder&quot;}">In subfolder</button>
            <button type="button" class="btn btn-sm btn-xs-third d-block d-sm-inline btn-light" data-action="edit_selected" data-item="hsd2loon9@cazehiresense.com" data-id="delimiter_action" data-api-url="edit/delimiter_action" data-api-attr="{&quot;tagged_mail_handler&quot;:&quot;subject&quot;}">In subject</button>
            <button type="button" class="btn btn-sm btn-xs-third d-block d-sm-inline btn-dark" data-action="edit_selected" data-item="hsd2loon9@cazehiresense.com" data-id="delimiter_action" data-api-url="edit/delimiter_action" data-api-attr="{&quot;tagged_mail_handler&quot;:&quot;none&quot;}">Do nothing</button>
          </div>
          <p class="text-muted">In subfolder: a new subfolder named after the tag will be created below INBOX ("INBOX/Facebook").<br>
In subject: the tags name will be prepended to the mails subject, example: "[Facebook] My News".</p>
          <p class="text-muted">Example for a tagged email address: me<b>+Facebook</b>@example.org</p>
        </div>
      </div>
            <div class="row">
        <div class="col-sm-3 col-12 text-sm-end text-start text-xs-bold mb-4">Encryption policy:</div>
        <div class="col-sm-9 col-12">
          <div class="btn-group" data-acl="1">
            <button type="button" class="btn btn-sm btn-xs-half d-block d-sm-inline btn-light" data-action="edit_selected" data-item="hsd2loon9@cazehiresense.com" data-id="tls_policy" data-api-url="edit/tls_policy" data-api-attr="{&quot;tls_enforce_in&quot;: 1 }">Enforce TLS incoming</button>
            <button type="button" class="btn btn-sm btn-xs-half d-block d-sm-inline btn-light" data-action="edit_selected" data-item="hsd2loon9@cazehiresense.com" data-id="tls_policy" data-api-url="edit/tls_policy" data-api-attr="{&quot;tls_enforce_out&quot;: 1 }">Enforce TLS outgoing</button>
          </div>
          <p class="text-muted"><strong>Warning:</strong> If you decide to enforce encrypted mail transfer, you may lose emails.<br>Messages to not satisfy the policy will be bounced with a hard fail by the mail system.<br>This option applies to your primary email address (login name), all addresses derived from alias domains as well as alias addresses <b>with only this single mailbox</b> as target.</p>
        </div>
      </div>
            <div class="row">
        <div class="col-sm-3 col-12 text-sm-end text-start text-xs-bold mb-4">Quarantine notifications:</div>
        <div class="col-sm-9 col-12">
          <div class="btn-group" data-acl="1">
            <button type="button" class="btn btn-sm btn-xs-quart d-block d-sm-inline btn-light" data-action="edit_selected" data-item="hsd2loon9@cazehiresense.com" data-id="quarantine_notification" data-api-url="edit/quarantine_notification" data-api-attr="{&quot;quarantine_notification&quot;:&quot;never&quot;}">Never</button>
            <button type="button" class="btn btn-sm btn-xs-quart d-block d-sm-inline btn-dark" data-action="edit_selected" data-item="hsd2loon9@cazehiresense.com" data-id="quarantine_notification" data-api-url="edit/quarantine_notification" data-api-attr="{&quot;quarantine_notification&quot;:&quot;hourly&quot;}">Hourly</button>
            <button type="button" class="btn btn-sm btn-xs-quart d-block d-sm-inline btn-light" data-action="edit_selected" data-item="hsd2loon9@cazehiresense.com" data-id="quarantine_notification" data-api-url="edit/quarantine_notification" data-api-attr="{&quot;quarantine_notification&quot;:&quot;daily&quot;}">Daily</button>
            <button type="button" class="btn btn-sm btn-xs-quart d-block d-sm-inline btn-light" data-action="edit_selected" data-item="hsd2loon9@cazehiresense.com" data-id="quarantine_notification" data-api-url="edit/quarantine_notification" data-api-attr="{&quot;quarantine_notification&quot;:&quot;weekly&quot;}">Weekly</button>
          </div>
          <p class="text-muted">Once a notification has been sent, items will be marked as "notified" and no further notifications will be sent for this particular item.</p>
        </div>
      </div>
      <div class="row">
        <div class="col-sm-3 col-12 text-sm-end text-start text-xs-bold mb-4">Quarantine notification category:</div>
        <div class="col-sm-9 col-12">
          <div class="btn-group" data-acl="1">
            <button type="button" class="btn btn-sm btn-xs-third d-block d-sm-inline btn-dark" data-action="edit_selected" data-item="hsd2loon9@cazehiresense.com" data-id="quarantine_category" data-api-url="edit/quarantine_category" data-api-attr="{&quot;quarantine_category&quot;:&quot;reject&quot;}">Rejected</button>
            <button type="button" class="btn btn-sm btn-xs-third d-block d-sm-inline btn-light" data-action="edit_selected" data-item="hsd2loon9@cazehiresense.com" data-id="quarantine_category" data-api-url="edit/quarantine_category" data-api-attr="{&quot;quarantine_category&quot;:&quot;add_header&quot;}">Junk folder</button>
            <button type="button" class="btn btn-sm btn-xs-third d-block d-sm-inline btn-light" data-action="edit_selected" data-item="hsd2loon9@cazehiresense.com" data-id="quarantine_category" data-api-url="edit/quarantine_category" data-api-attr="{&quot;quarantine_category&quot;:&quot;all&quot;}">All categories</button>
          </div>
          <p class="text-muted">The notification category "Rejected" includes mail that was rejected, while "Junk folder" will notify a user about mails that were put into the junk folder.</p>
        </div>
      </div>
            <hr>
      <div class="row">
        <div class="col-sm-3 col-12 text-sm-end text-start text-xs-bold mb-4">Reset ActiveSync device cache:</div>
        <div class="col-sm-9 col-12">
          <button class="btn btn-sm d-block d-sm-inline btn-secondary" data-acl="1" data-action="delete_selected" data-text="Reset ActiveSync device cache?" data-item="hsd2loon9@cazehiresense.com" data-id="eas_cache" data-api-url="delete/eas_cache" href="#">Reset now</button>
          <p class="text-muted">In many cases a device cache reset will help to recover a broken ActiveSync profile.<br><b>Attention:</b> All elements will be redownloaded!</p>
        </div>
      </div>
      <div class="row">
        <div class="col-sm-3 col-12 text-sm-end text-start text-xs-bold mb-4">Reset SOGo profile:</div>
        <div class="col-sm-9 col-12">
          <button class="btn btn-sm d-block d-sm-inline btn-secondary" data-acl="0" data-action="delete_selected" data-text="Reset SOGo profile?" data-item="hsd2loon9@cazehiresense.com" data-id="sogo_profile" data-api-url="delete/sogo_profile" href="#" disabled="disabled" title="" data-bs-original-title="Prohibited by ACL">Reset profile now</button>
          <p class="text-muted">This will destroy a user's SOGo profile and <b>delete all contact and calendar data irretrievable</b>.</p>
        </div>
      </div>
          </div>
  </div>
</div>
        <div class="tab-pane fade" id="SpamAliases" role="tabpanel" aria-labelledby="SpamAliases">
  <div class="card mb-4">
    <div class="card-header d-flex fs-5">
      <button class="btn d-md-none flex-grow-1 text-start" data-bs-target="#collapse-tab-SpamAliases" data-bs-toggle="collapse" aria-controls="collapse-tab-SpamAliases">
        Spam email aliases
      </button>
      <span class="d-none d-md-block">Spam email aliases</span>
    </div>
    <div id="collapse-tab-SpamAliases" class="card-body collapse" data-bs-parent="#user-content">
      <div class="row">
        <p>A spam alias is a temporary email address that can be used to protect real email addresses. <br>Optionally, an expiration time can be set so that the alias is automatically deactivated after the defined period, effectively disposing of abused or leaked addresses.</p>
        <div class="col-md-12 col-sm-12 col-12">
          <table id="tla_table" class="table table-striped dt-responsive w-100"></table>
        </div>
      </div>
      <div class="mass-actions-user">
        <div class="btn-group" data-acl="1">
          <div class="btn-group">
            <a class="btn btn-sm btn-xs-half d-block d-sm-inline btn-secondary" id="toggle_multi_select_all" data-id="tla" href="#"><i class="bi bi-check-all"></i> Toggle all</a>
            <a class="btn btn-sm btn-xs-half d-block d-sm-inline btn-secondary dropdown-toggle" data-bs-toggle="dropdown" href="#">Actions</a>
            <ul class="dropdown-menu">
              <li><a class="dropdown-item" data-action="edit_selected" data-id="tla" data-api-url="edit/time_limited_alias" data-api-attr="{&quot;validity&quot;:&quot;1&quot;,&quot;permanent&quot;:&quot;0&quot;}" href="#">Expire in 1 hour</a></li>
              <li><a class="dropdown-item" data-action="edit_selected" data-id="tla" data-api-url="edit/time_limited_alias" data-api-attr="{&quot;validity&quot;:&quot;24&quot;,&quot;permanent&quot;:&quot;0&quot;}" href="#">Expire in 1 day</a></li>
              <li><a class="dropdown-item" data-action="edit_selected" data-id="tla" data-api-url="edit/time_limited_alias" data-api-attr="{&quot;validity&quot;:&quot;168&quot;,&quot;permanent&quot;:&quot;0&quot;}" href="#">Expire in 1 week</a></li>
              <li><a class="dropdown-item" data-action="edit_selected" data-id="tla" data-api-url="edit/time_limited_alias" data-api-attr="{&quot;validity&quot;:&quot;744&quot;,&quot;permanent&quot;:&quot;0&quot;}" href="#">Expire in 1 month</a></li>
              <li><a class="dropdown-item" data-action="edit_selected" data-id="tla" data-api-url="edit/time_limited_alias" data-api-attr="{&quot;validity&quot;:&quot;8760&quot;,&quot;permanent&quot;:&quot;0&quot;}" href="#">Expire in 1 year</a></li>
              <li><a class="dropdown-item" data-action="edit_selected" data-id="tla" data-api-url="edit/time_limited_alias" data-api-attr="{&quot;validity&quot;:&quot;87600&quot;,&quot;permanent&quot;:&quot;0&quot;}" href="#">Expire in 10 years</a></li>
              <li><a class="dropdown-item" data-action="edit_selected" data-id="tla" data-api-url="edit/time_limited_alias" data-api-attr="{&quot;permanent&quot;:&quot;1&quot;}" href="#">Never Expire</a></li>
              <li><hr class="dropdown-divider"></li>
              <li><a class="dropdown-item" data-action="delete_selected" data-id="tla" data-api-url="delete/time_limited_alias" href="#">Remove</a></li>
            </ul>
          </div>
          <div class="btn-group">
            <a class="btn btn-sm d-block d-sm-inline btn-success dropdown-toggle" data-bs-toggle="dropdown" href="#"><i class="bi bi-plus-lg"></i> Generate random alias, 1 year</a>
            <ul class="dropdown-menu">
                              <li>
                  <a class="dropdown-item" data-bs-toggle="modal" data-bs-target="#tempAliasModal" onclick="$(&quot;#tempAliasModal #temp_alias_domain&quot;).val(&quot;cazehiresense.com&quot;)" href="#">
                    @ cazehiresense.com
                  </a>
                </li>
                          </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
        <div class="tab-pane fade" id="Spamfilter" role="tabpanel" aria-labelledby="Spamfilter">
  <div class="card mb-4">
    <div class="card-header d-flex fs-5">
      <button class="btn d-md-none flex-grow-1 text-start" data-bs-target="#collapse-tab-Spamfilter" data-bs-toggle="collapse" aria-controls="collapse-tab-Spamfilter">
        Spam filter
      </button>
      <span class="d-none d-md-block">Spam filter</span>
    </div>
    <div id="collapse-tab-Spamfilter" class="card-body collapse" data-bs-parent="#user-content">
      <h4>Rating</h4>
      <div class="row">
        <div class="col-sm-12">
          <form class="form-horizontal" role="form" data-id="spam_score" method="post">
            <div class="row">
              <div class="col-sm-12">
                <div id="spam_score" data-provide="slider" data-acl="1" class="noUi-target noUi-ltr noUi-horizontal noUi-txt-dir-ltr"><div class="noUi-base"><div class="noUi-connects"><div class="noUi-connect c-1-color" style="transform: translate(0%, 0px) scale(0.4, 1);"></div><div class="noUi-connect c-2-color" style="transform: translate(40%, 0px) scale(0.2, 1);"></div><div class="noUi-connect c-3-color" style="transform: translate(60%, 0px) scale(0.4, 1);"></div></div><div class="noUi-origin" style="transform: translate(-600%, 0px); z-index: 5;"><div class="noUi-handle noUi-handle-lower" data-handle="0" tabindex="0" role="slider" aria-orientation="horizontal" aria-valuemin="0.0" aria-valuemax="15.0" aria-valuenow="8.0" aria-valuetext="8.00"><div class="noUi-touch-area"></div></div></div><div class="noUi-origin" style="transform: translate(-400%, 0px); z-index: 4;"><div class="noUi-handle noUi-handle-upper" data-handle="1" tabindex="0" role="slider" aria-orientation="horizontal" aria-valuemin="8.0" aria-valuemax="5000.0" aria-valuenow="15.0" aria-valuetext="15.00"><div class="noUi-touch-area"></div></div></div></div></div>
                <input id="spam_score_value" name="spam_score" type="hidden" value="8,15">
                <ul class="list-group list-group-flush">
                  <li class="list-group-item"><span class="label label-ham spam-ham-score">&lt; 8</span> Green: this message is not spam</li>
                  <li class="list-group-item"><span class="label label-spam spam-spam-score">8 - 15</span> Yellow: this message may be spam, will be tagged as spam and moved to your junk folder</li>
                  <li class="list-group-item"><span class="label label-reject spam-reject-score">&gt; 15</span> Red: This message is spam and will be rejected by the server</li>
                </ul>
              </div>
            </div>
            <div class="btn-group mt-4" data-acl="1">
              <a type="button" class="btn btn-sm btn-xs-half d-block d-sm-inline btn-success" data-action="edit_selected" data-item="hsd2loon9@cazehiresense.com" data-id="spam_score" data-api-url="edit/spam-score" data-api-attr="{}"><i class="bi bi-save"></i> Save changes</a>
              <a type="button" class="btn btn-sm btn-xs-half d-block d-sm-inline btn-secondary" data-action="edit_selected" data-item="hsd2loon9@cazehiresense.com" data-id="spam_score_reset" data-api-url="edit/spam-score" data-api-attr="{&quot;spam_score&quot;:&quot;default&quot;}">Reset to server default</a>
            </div>
          <input type="hidden" value="a5e6f51085b6fcb8adc07084305e3956154d5683abdb5f23eb17f4a1dc5844df" name="csrf_token"></form>
        </div>
      </div>
      <hr>
      <div class="row">
        <div class="col-lg-6 my-3 d-flex flex-column">
          <h4>Allowlist</h4>
          <p>Allowlisted email addresses are programmed to <b>never</b> classify as spam. Wildcards may be used. A filter is only applied to direct aliases (aliases with a single target mailbox) excluding catch-all aliases and a mailbox itself.</p>
          <form class="form-inline mb-4 mt-auto" data-id="add_wl_policy_mailbox">
            <div class="input-group" data-acl="1">
              <input type="text" class="form-control" name="object_from" placeholder="*@example.org" required="">
              <button class="btn btn-secondary" data-action="add_item" data-id="add_wl_policy_mailbox" data-api-url="add/mailbox-policy" data-api-attr="{&quot;username&quot;: &quot;hsd2loon9@cazehiresense.com&quot;,&quot;object_list&quot;:&quot;wl&quot;}" href="#"><i class="bi bi-plus-lg"></i> Add item</button>
            </div>
          <input type="hidden" value="a5e6f51085b6fcb8adc07084305e3956154d5683abdb5f23eb17f4a1dc5844df" name="csrf_token"></form>
          <table id="wl_policy_mailbox_table" class="table table-striped dt-responsive w-100"></table>
          <div class="mass-actions-user">
            <div class="btn-group" data-acl="1">
              <a class="btn btn-sm btn-xs-half d-block d-sm-inline btn-secondary" id="toggle_multi_select_all" data-id="policy_wl_mailbox" href="#"><i class="bi bi-check-all"></i> Toggle all</a>
              <a class="btn btn-sm btn-xs-half d-block d-sm-inline btn-secondary dropdown-toggle" data-bs-toggle="dropdown" href="#">Actions</a>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item" data-datatables-expand="wl_policy_mailbox_table" data-table="wl_policy_mailbox_table" href="#">Expand All</a></li>
                <li><a class="dropdown-item" data-datatables-collapse="wl_policy_mailbox_table" data-table="wl_policy_mailbox_table" href="#">Collapse All</a></li>
              </ul>
              <a class="btn btn-sm btn-xs-half d-block d-sm-inline btn-danger" data-action="delete_selected" data-id="policy_wl_mailbox" data-api-url="delete/mailbox-policy" href="#">Remove</a>
            </div>
          </div>
        </div>
        <div class="col-lg-6 my-3 d-flex flex-column">
          <h4>Denylist</h4>
          <p>Denylisted email addresses to <b>always</b> classify as spam and reject. Rejected mail will <b>not</b> be copied to quarantine. Wildcards may be used. A filter is only applied to direct aliases (aliases with a single target mailbox) excluding catch-all aliases and a mailbox itself.</p>
          <form class="form-inline mb-4 mt-auto" data-id="add_bl_policy_mailbox">
            <div class="input-group" data-acl="1">
              <input type="text" class="form-control" name="object_from" placeholder="*@example.org" required="">
              <button class="btn btn-secondary" data-action="add_item" data-id="add_bl_policy_mailbox" data-api-url="add/mailbox-policy" data-api-attr="{&quot;username&quot;: &quot;hsd2loon9@cazehiresense.com&quot;,&quot;object_list&quot;:&quot;bl&quot;}" href="#"><i class="bi bi-plus-lg"></i> Add item</button>
            </div>
          <input type="hidden" value="a5e6f51085b6fcb8adc07084305e3956154d5683abdb5f23eb17f4a1dc5844df" name="csrf_token"></form>
          <table id="bl_policy_mailbox_table" class="table table-striped dt-responsive w-100"></table>
          <div class="mass-actions-user">
            <div class="btn-group" data-acl="1">
              <a class="btn btn-sm btn-xs-half d-block d-sm-inline btn-secondary" id="toggle_multi_select_all" data-id="policy_bl_mailbox" href="#"><i class="bi bi-check-all"></i> Toggle all</a>
              <a class="btn btn-sm btn-xs-half d-block d-sm-inline btn-secondary dropdown-toggle" data-bs-toggle="dropdown" href="#">Actions</a>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item" data-datatables-expand="bl_policy_mailbox_table" data-table="bl_policy_mailbox_table" href="#">Expand All</a></li>
                <li><a class="dropdown-item" data-datatables-collapse="bl_policy_mailbox_table" data-table="bl_policy_mailbox_table" href="#">Collapse All</a></li>
              </ul>
              <a class="btn btn-sm btn-xs-half d-block d-sm-inline btn-danger" data-action="delete_selected" data-id="policy_bl_mailbox" data-api-url="delete/mailbox-policy" href="#">Remove</a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
                <div class="tab-pane fade" id="AppPasswds" role="tabpanel" aria-labelledby="AppPasswds">
  <div class="card mb-4">
    <div class="card-header d-flex fs-5">
      <button class="btn d-md-none flex-grow-1 text-start" data-bs-target="#collapse-tab-AppPasswds" data-bs-toggle="collapse" aria-controls="collapse-tab-AppPasswds">
        App passwords
      </button>
      <span class="d-none d-md-block">App passwords</span>
    </div>
    <div id="collapse-tab-AppPasswds" class="card-body collapse" data-bs-parent="#user-content">
      <div class="mass-actions-user mb-4">
        <div class="btn-group" data-acl="1">
          <div class="btn-group">
            <a class="btn btn-sm btn-xs-half d-block d-sm-inline btn-secondary" id="toggle_multi_select_all" data-id="apppasswd" href="#"><i class="bi bi-check-all"></i> Toggle all</a>
            <a class="btn btn-sm btn-xs-half d-block d-sm-inline btn-secondary dropdown-toggle" data-bs-toggle="dropdown" href="#">Actions</a>
            <ul class="dropdown-menu">
              <li><a class="dropdown-item" data-action="edit_selected" data-id="apppasswd" data-api-url="edit/app-passwd" data-api-attr="{&quot;active&quot;:&quot;1&quot;}" href="#">Activate</a></li>
              <li><a class="dropdown-item" data-action="edit_selected" data-id="apppasswd" data-api-url="edit/app-passwd" data-api-attr="{&quot;active&quot;:&quot;0&quot;}" href="#">Deactivate</a></li>
              <li><hr class="dropdown-divider"></li>
              <li><a class="dropdown-item" data-datatables-expand="app_passwd_table" data-table="app_passwd_table" href="#">Expand All</a></li>
              <li><a class="dropdown-item" data-datatables-collapse="app_passwd_table" data-table="app_passwd_table" href="#">Collapse All</a></li>
              <li><hr class="dropdown-divider"></li>
              <li><a class="dropdown-item" data-action="delete_selected" data-id="apppasswd" data-api-url="delete/app-passwd" href="#">Remove</a></li>
            </ul>
          </div>
          <div class="btn-group">
            <a class="btn btn-sm d-block d-sm-inline btn-success" href="#" data-bs-toggle="modal" data-bs-target="#addAppPasswdModal"><i class="bi bi-plus-lg"></i> Create app password</a>
          </div>
        </div>
      </div>
      <p>App passwords are alternative passwords for your IMAP, SMTP, CalDAV, CardDAV and EAS login. The username remains unchanged. SOGo webmail is not available through app passwords.</p>
      <table id="app_passwd_table" class="table table-striped dt-responsive w-100"></table>
      <div class="mass-actions-user mt-4">
        <div class="btn-group" data-acl="1">
          <div class="btn-group">
            <a class="btn btn-sm btn-xs-half d-block d-sm-inline btn-secondary" id="toggle_multi_select_all" data-id="apppasswd" href="#"><i class="bi bi-check-all"></i> Toggle all</a>
            <a class="btn btn-sm btn-xs-half d-block d-sm-inline btn-secondary dropdown-toggle" data-bs-toggle="dropdown" href="#">Actions</a>
            <ul class="dropdown-menu">
              <li><a class="dropdown-item" data-action="edit_selected" data-id="apppasswd" data-api-url="edit/app-passwd" data-api-attr="{&quot;active&quot;:&quot;1&quot;}" href="#">Activate</a></li>
              <li><a class="dropdown-item" data-action="edit_selected" data-id="apppasswd" data-api-url="edit/app-passwd" data-api-attr="{&quot;active&quot;:&quot;0&quot;}" href="#">Deactivate</a></li>
              <li><hr class="dropdown-divider"></li>
              <li><a class="dropdown-item" data-datatables-expand="app_passwd_table" data-table="app_passwd_table" href="#">Expand All</a></li>
              <li><a class="dropdown-item" data-datatables-collapse="app_passwd_table" data-table="app_passwd_table" href="#">Collapse All</a></li>
              <li><hr class="dropdown-divider"></li>
              <li><a class="dropdown-item" data-action="delete_selected" data-id="apppasswd" data-api-url="delete/app-passwd" href="#">Remove</a></li>
            </ul>
          </div>
          <div class="btn-group">
            <a class="btn btn-sm d-block d-sm-inline btn-success" href="#" data-bs-toggle="modal" data-bs-target="#addAppPasswdModal"><i class="bi bi-plus-lg"></i> Create app password</a>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
        <div class="tab-pane fade" id="Pushover" role="tabpanel" aria-labelledby="Pushover">
  <div class="card mb-4">
    <div class="card-header d-flex fs-5">
      <button class="btn d-md-none flex-grow-1 text-start" data-bs-target="#collapse-tab-Pushover" data-bs-toggle="collapse" aria-controls="collapse-tab-Pushover">
        Pushover API
      </button>
      <span class="d-none d-md-block">Pushover API</span>
    </div>
    <div id="collapse-tab-Pushover" class="card-body collapse" data-bs-parent="#user-content">
      <form data-id="pushover" class="form well" method="post">
        <input type="hidden" value="0" name="evaluate_x_prio">
        <input type="hidden" value="0" name="only_x_prio">
        <input type="hidden" value="0" name="active">
        <div class="row">
          <div class="col-sm-1">
            <p class="text-muted"><a href="https://pushover.net" target="_blank"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAACglBMVEUAAAAAAAEAAAAilecFGigAAAAAAAAAAAAAAAANj+c3n+Ypm+oeYI4KWI4MieAtkdQbleoJcLcjmeswmN4Rit4KgdMKUYQJKUAQSnILL0kMNlMSTngimOoNPF0hlOQBBgkNOlkRS3MHIjUhk+IPf8wKLUYsjM0AAAASTngAAAAAAAAPfckbdLIbdrYUWIgegsgce70knfEAAAAknfENOVkGHi8YaaIjnvEdgMUhkuAQSG8aca0hleQUh9YLjOM4nOEMgtMcbaYWa6YemO02ltkKhNktgLodYZEPXJEyi8kKesktfLUzj84cWYMiluckZ5YJXJYeW4Y0k9YKfs4yjs0pc6YHZaUviskLfMkqmugak+cqkNcViNcqeK4Iaq4XRmYGPmYMKDsFJTstgr0LdL0ti84CCQ4BCQ4Qgc8rlt8XjN8shcQsi8wZSGgEP2cRMEUDKkUAAAD///8dmvEamfExo/EXmPEWl/ERlvElnvEsofEjnfETl/Enn/Ezo/E4pvEvovEfm/E1pPEzpPEvofEOlfEpoPEamPEQlfEYmfE6p/EgnPEVlvEroPE3pfE2pfENk/Ern/E3pPEcmfEfmvEnnvBlufT6/P0soPAknPDd7/zs9vzo9PxBqfItofAqoPD9/f3B4/q43/mx2/l/xfZ6w/Vxv/VtvfVgt/RXtPNTsfNEq/L3+/31+v3a7fvR6vvH5fqs2vmc0/jx+P3v9/3h8fzW7PvV7PvL5/q13fmo1/mh1PiY0fiNy/aHyfZ2wfVou/Vdt/RPsPM3oeoQkuowmeAgjdgcgMQbeLrw9/3k8vy74Pm63/mX0PdYtfNNr/Ikm+4wnOchkuAVjOAfdrMVcrOdoJikAAAAcnRSTlMAIQ8IzzweFwf+/fvw8P79+/Xt7e3p6eji4d7U08y8qZyTiIWDgn53bWxqaWBKQ0JBOjUwMCkoJCEfHBkT/vz8/Pv7+vr69/b29PTy7ezm5ubm5N7e29vQ0M/Pv7+4uLW1pqaWloWDg3x7e21mUVFFRUXdPracAAAEbElEQVRIx4WUZbvaQBCFF+ru7u7u7u7u7t4mvVwSoBC0JIUCLRQolLq7u7vr/+nMLkmQyvlwyfPcd86e3ZldUqwyQ/p329J+XfutPQYOLUP+q55rFtQJRvY79+xxlZTUWbKpz7/xrrMr2+3BoNPpdLn2lJQ4HEeqLOr1d7z7XNkesQed4A848G63Oy4Gmg/6Mz542QvZbqe8C/Ig73CLYiYTrtLmT3zfqbIcAR7y4wIqH/B6M9Fo0+Ldb6sM9ph/v4ozPuz12mxRofaAAr7jCNkuoz/jNf9AGHibkBCm51fsGKvxsAGWx4H+jBcEi6V2birDpCL/9Klrd1KHbiSvPWP8V0tTnTfO03iXi57P6WNHOVUf44IFdFDRz6pV5fw8Zy5z3JVH5+R48OwxqDiGvKJIY9R+9JsCuJ5HPg74OVEMpz+nbdEPUHEWeEk6IDUnTC1l5r+f8uffc0cfxc8fS17kLso24SwUPFDA/6DE82xKDOPliJ7n/GGOOyWK9zD9CdjvOfg9Dv6AH+AX04LW9gj2i8W/APx1UbxwCAu+wPmcpgUKL/EHdvtq4uwaZwCuznPJVY5LHhED15G/isd5Hz4eKui/e/du02YoKFeD5mHzHIN/nxEDe25gQQwKorAid04CfyzwL4XutXvl1Pt1guMOwwKPkU8mYIFT8JHK+vv8prpDScUVL+j8s3lOctw1GIhbWHAS+HgKPk7xPM/4UtNAYmzizJkf6NgTb/gM8jePQLsewMdthS3g95tMpT1IhVm6v1s8fYmLeb13Odwp8Fh5KY048y/d14WUrwrb1e/X/rNp73nkD8kWS+wi/MZ4XuetG4mhKubJm3/WNEvi8SHwB56nPKjUam0LBdp9ARwupFemTYudvgN/L1+A/Ko/LGBuS8pPy+YR1fuCTWNKnUyoeUyYx2o2dyEVGmr5xTD42xzvkD16+Pb9WIIH6fmt1r3mbsTY7Bvw+n23naT8BUWh86bz6G/e259UXPUK3gfAxQDlo7Rpx3Geqb2e3wp83SGEdKpB7zvwYbzvT2n65xLwbH6YP+M9C8vA8E1wxLU8gkCbdhXGUyrMgwVrcbzLHonr78lzDvWM3q/C/HtDlXoSUIe3YkblhRPIX4E8Oo/9siLv8dRjV7SBlkdgTXvKS7nzsA/9AfeEuhKq9T8zWIDv1Sd6ETAP4D6/H/1V+1BojvruNa4SZXz4JhY84dV5MOF5agUvu5OsOo+KRpG30KalEnoeDccFlutPZYs38D5n3zcpr1/0fBhfb3DOY1z2tSAgLxWezz6zuoHhfUmOejf6blHQH/sFuJYfcMZX307ytKvRa3ifoV/586P5j+tICtS77BuJxzxYAPZsntX8k3eSIhlajK4p8b7iefCEKs03kD/I2LnxL9ovH+43y4fAv1YrI/mzDBsavAX/UppfzVOrZT/ydxk6lJ047MfLfVbcb6hS9ZEzWxekKQ5WrtPqZg3rV6tWrX6Tle3KQZj/q6KxQnmDoXwFY0VSrN9e8FRXBCTAvwAAAABJRU5ErkJggg==" class="img img-fluid"></a></p>
          </div>
          <div class="col-sm-10">
            <p class="text-muted">Push notification settings will apply to all clean (non-spam) mail delivered to <b>hsd2loon9@cazehiresense.com</b> including aliases (shared, non-shared, tagged).</p>
            <p class="text-muted">When no sender filter is defined, all mails will be considered.<br>Regex filters as well as exact sender checks can be defined individually and will be considered sequentially. They do not depend on each other.<br>Useable variables for text and title (please take note of data protection policies): <code>{SUBJECT}</code>, <code>{SENDER}</code>, <code>{SENDER_ADDRESS}</code>, <code>{SENDER_NAME}</code>, <code>{TO_NAME}</code>, <code>{TO_ADDRESS}</code>, <code>{MSG_ID}</code></p>
            <div class="row">
              <div class="col-sm-6 mb-2">
                <div class="form-group">
                  <label for="token">API Token/Key (Application)</label>
                  <input type="text" class="form-control" name="token" maxlength="30" value="" required="">
                </div>
              </div>
              <div class="col-sm-6 mb-2">
                <div class="form-group">
                  <label for="key">User/Group Key</label>
                  <input type="text" class="form-control" name="key" maxlength="30" value="" required="">
                </div>
              </div>
              <div class="col-sm-6 mb-2">
                <div class="form-group">
                  <label for="title">Notification title</label>
                  <input type="text" class="form-control" name="title" value="" placeholder="Mail">
                </div>
              </div>
              <div class="col-sm-6 mb-2">
                <div class="form-group">
                  <label for="text">Notification text</label>
                  <input type="text" class="form-control" name="text" value="" placeholder="You've got mail 📧">
                </div>
              </div>
              <div class="col-sm-12 mb-4">
                <div class="form-group">
                  <label for="text">Consider the following sender email addresses <small>(comma-separated)</small></label>
                  <input type="text" class="form-control" name="senders" value="" placeholder="sender1@example.com, sender2@example.com">
                </div>
              </div>
              <div class="col-sm-12 mb-2">
              <div class="form-group">
                <label for="sound">Sound</label><br>
                <div class="dropdown bootstrap-select form-control"><select name="sound" class="form-control">
                  <option value="pushover">Pushover (default)</option>
                  <option value="bike">Bike</option>
                  <option value="bugle">Bugle</option>
                  <option value="cashregister">Cash Register</option>
                  <option value="classical">Classical</option>
                  <option value="cosmic">Cosmic</option>
                  <option value="falling">Falling</option>
                  <option value="gamelan">Gamelan</option>
                  <option value="incoming">Incoming</option>
                  <option value="intermission">Intermission</option>
                  <option value="magic">Magic</option>
                  <option value="mechanical">Mechanical</option>
                  <option value="pianobar">Piano Bar</option>
                  <option value="siren">Siren</option>
                  <option value="spacealarm">Space Alarm</option>
                  <option value="tugboat">Tug Boat</option>
                  <option value="alien">Alien Alarm (long)</option>
                  <option value="climb">Climb (long)</option>
                  <option value="persistent">Persistent (long)</option>
                  <option value="echo">Pushover Echo (long)</option>
                  <option value="updown">Up Down (long)</option>
                  <option value="vibrate">Vibrate Only</option>
                  <option value="none"> None (silent) </option>
                </select><button type="button" tabindex="-1" class="btn btn-xs-lg dropdown-toggle btn-light" data-bs-toggle="dropdown" role="combobox" aria-owns="bs-select-2" aria-haspopup="listbox" aria-expanded="false" title="Pushover (default)"><div class="filter-option"><div class="filter-option-inner"><div class="filter-option-inner-inner">Pushover (default)</div></div> </div></button><div class="dropdown-menu "><div class="inner show" role="listbox" id="bs-select-2" tabindex="-1"><ul class="dropdown-menu inner show" role="presentation"></ul></div></div></div>
              </div>
            </div>
            <div class="col-sm-12">
                <div class="form-check">
                  <label><input type="checkbox" class="form-check-input" value="1" name="active"> Active</label>
                </div>
              </div>
              <div class="col-sm-12">
                <legend style="cursor:pointer;margin-top:10px" data-bs-target="#po_advanced" unselectable="on" data-bs-toggle="collapse">
                  <i style="font-size:10pt;" class="bi bi-plus-square"></i> Advanced settings
                </legend>
                <hr>
              </div>
              <div class="col-sm-12 mb-4">
                <div id="po_advanced" class="collapse">
                  <div class="form-group">
                    <label for="text">Match senders by the following regex</label>
                    <input type="text" class="form-control mb-4" name="senders_regex" value="" placeholder="/(.*@example\.org$|^foo@example\.com$)/i" regex="true">
                    <div class="form-check">
                      <label><input type="checkbox" class="form-check-input" value="1" name="evaluate_x_prio"> Escalate high priority mail [<code>X-Priority: 1</code>]</label>
                    </div>
                    <div class="form-check">
                      <label><input type="checkbox" class="form-check-input" value="1" name="only_x_prio"> Only consider high priority mail [<code>X-Priority: 1</code>]</label>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="btn-group mass-actions-user mb-2" data-acl="1">
              <a class="btn btn-sm btn-xs-half d-block d-sm-inline btn-success" data-action="edit_selected" data-id="pushover" data-item="hsd2loon9@cazehiresense.com" data-api-url="edit/pushover" data-api-attr="{}" href="#">Save changes</a>
              <a class="btn btn-sm btn-xs-half d-block d-sm-inline btn-secondary" data-action="edit_selected" data-id="pushover-test" data-item="hsd2loon9@cazehiresense.com" data-api-url="edit/pushover-test" data-api-attr="{}" href="#"><i class="bi bi-check-all"></i> Verify credentials</a>
              <a id="pushover_delete" class="btn btn-sm d-block d-sm-inline btn-danger" data-action="edit_selected" data-id="pushover-delete" data-item="hsd2loon9@cazehiresense.com" data-api-url="edit/pushover" data-api-attr="{&quot;delete&quot;:&quot;true&quot;}" href="#"><i class="bi bi-trash"></i> Remove</a>
            </div>
          </div>
        </div>
      <input type="hidden" value="a5e6f51085b6fcb8adc07084305e3956154d5683abdb5f23eb17f4a1dc5844df" name="csrf_token"></form>
    </div>
  </div>
</div>
      </div>
    </div>
  </div>
  <!-- change fido2 fn -->
<div class="modal fade" id="fido2ChangeFn" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">Set friendly name</h3>
        <p class="text-muted" style="word-break:break-all" id="fido2_subject_desc" data-fido2-subject=""></p>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form class="form-horizontal" data-cached-form="false" data-id="fido2ChangeFn" role="form" method="post" autocomplete="off">
          <input type="hidden" class="form-control" name="fido2_cid" id="fido2_cid">
          <div class="row mb-4">
            <label class="control-label col-sm-4 text-end" for="fido2_fn">Friendly name:</label>
            <div class="col-sm-8">
              <input type="text" class="form-control" name="fido2_fn">
            </div>
          </div>
          <div class="row">
            <div class="offset-sm-4 col-sm-8">
              <button class="btn btn-xs-lg d-block d-sm-inline btn-success" data-action="edit_selected" data-id="fido2ChangeFn" data-item="null" data-api-url="edit/fido2-fn" data-api-attr="{}" href="#">Save changes</button>
            </div>
          </div>
        <input type="hidden" value="a5e6f51085b6fcb8adc07084305e3956154d5683abdb5f23eb17f4a1dc5844df" name="csrf_token"></form>
      </div>
    </div>
  </div>
</div><!-- add domain admin modal -->
<!-- add sync job modal -->
<div class="modal fade" id="addSyncJobModal" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">Add sync job</h3>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <p>Be aware that passwords need to be saved plain-text!</p>
        <form class="form-horizontal" data-cached-form="true" role="form" data-id="add_syncjob">
          <div class="row mb-2">
            <label class="control-label col-sm-2" for="host1">Host</label>
            <div class="col-sm-10">
              <input type="text" class="form-control" name="host1" required="">
            </div>
          </div>
          <div class="row mb-4">
            <label class="control-label col-sm-2" for="port1">Port</label>
            <div class="col-sm-10">
              <input type="number" class="form-control" name="port1" min="1" max="65535" value="143" required="">
              <small class="text-muted">1-65535</small>
            </div>
          </div>
          <div class="row mb-2">
            <label class="control-label col-sm-2" for="user1">Username</label>
            <div class="col-sm-10">
              <input type="text" class="form-control" name="user1" required="">
            </div>
          </div>
          <div class="row mb-4">
            <label class="control-label col-sm-2" for="password1">Password</label>
            <div class="col-sm-10">
              <input type="password" class="form-control" name="password1" data-hibp="true" required=""><p class="small haveibeenpwned"><i class="bi bi-shield-fill-exclamation"></i> Check against haveibeenpwned.com</p><span class="hibp-out"></span><p class="help-block small">- Minimum password length is 6</p>
            </div>
          </div>
          <div class="row mb-2">
            <label class="control-label col-sm-2" for="enc1">Encryption method</label>
            <div class="col-sm-10">
              <div class="dropdown bootstrap-select"><select name="enc1" title="Please select..." required="" class=""><option class="bs-title-option" value=""></option>
                <option value="SSL" selected="">SSL</option>
                <option value="TLS">STARTTLS</option>
                <option value="PLAIN">PLAIN</option>
              </select><button type="button" tabindex="-1" class="btn btn-xs-lg dropdown-toggle btn-light" data-bs-toggle="dropdown" role="combobox" aria-owns="bs-select-3" aria-haspopup="listbox" aria-expanded="false" title="SSL"><div class="filter-option"><div class="filter-option-inner"><div class="filter-option-inner-inner">SSL</div></div> </div></button><div class="dropdown-menu "><div class="inner show" role="listbox" id="bs-select-3" tabindex="-1"><ul class="dropdown-menu inner show" role="presentation"></ul></div></div></div>
            </div>
          </div>
          <div class="row mb-2">
            <label class="control-label col-sm-2" for="mins_interval">Polling interval (minutes)</label>
            <div class="col-sm-10">
              <input type="number" class="form-control" name="mins_interval" min="1" max="43800" value="20" required="">
              <small class="text-muted">1-43800</small>
            </div>
          </div>
          <div class="row mb-2">
            <label class="control-label col-sm-2" for="subfolder2">Sync into subfolder on destination<br><small>(empty = do not use subfolder)</small></label>
            <div class="col-sm-10">
              <input type="text" class="form-control" name="subfolder2" value="">
            </div>
          </div>
          <div class="row mb-2">
            <label class="control-label col-sm-2" for="maxage">Maximum age of messages in days that will be polled from remote<br><small>(0 = ignore age)</small></label>
            <div class="col-sm-10">
              <input type="number" class="form-control" name="maxage" min="0" max="32000" value="0">
              <small class="text-muted">0-32000</small>
            </div>
          </div>
          <div class="row mb-2">
            <label class="control-label col-sm-2" for="maxbytespersecond">Max. bytes per second <br><small>(0 = unlimited)</small></label>
            <div class="col-sm-10">
              <input type="number" class="form-control" name="maxbytespersecond" min="0" max="125000000" value="0">
              <small class="text-muted">0-125000000</small>
            </div>
          </div>
          <div class="row mb-2">
            <label class="control-label col-sm-2" for="timeout1">Timeout for connection to remote host</label>
            <div class="col-sm-10">
              <input type="number" class="form-control" name="timeout1" min="1" max="32000" value="600">
              <small class="text-muted">1-32000</small>
            </div>
          </div>
          <div class="row mb-2">
            <label class="control-label col-sm-2" for="timeout2">Timeout for connection to local host</label>
            <div class="col-sm-10">
              <input type="number" class="form-control" name="timeout2" min="1" max="32000" value="600">
              <small class="text-muted">1-32000</small>
            </div>
          </div>
          <div class="row mb-2">
            <label class="control-label col-sm-2" for="exclude">Exclude objects (regex)</label>
            <div class="col-sm-10">
              <input type="text" class="form-control" name="exclude" value="(?i)spam|(?i)junk">
            </div>
          </div>
          <div class="row mb-4">
            <label class="control-label col-sm-2" for="custom_params">Custom parameters</label>
            <div class="col-sm-10">
              <input type="text" class="form-control" name="custom_params" placeholder="--delete2folders --otheroption">
            </div>
          </div>
          <div class="row mb-2">
            <div class="offset-sm-2 col-sm-10">
              <div class="form-check">
                <label><input type="checkbox" class="form-check-input" value="1" name="delete2duplicates" checked=""> Delete duplicates on destination (--delete2duplicates)</label>
              </div>
            </div>
          </div>
          <div class="row mb-2">
            <div class="offset-sm-2 col-sm-10">
              <div class="form-check">
                <label><input type="checkbox" class="form-check-input" value="1" name="delete1"> Delete from source when completed (--delete1)</label>
              </div>
            </div>
          </div>
          <div class="row mb-2">
            <div class="offset-sm-2 col-sm-10">
              <div class="form-check">
                <label><input type="checkbox" class="form-check-input" value="1" name="delete2"> Delete messages on destination that are not on source (--delete2)</label>
              </div>
            </div>
          </div>
          <div class="row mb-2">
            <div class="offset-sm-2 col-sm-10">
              <div class="form-check">
                <label><input type="checkbox" class="form-check-input" value="1" name="automap" checked=""> Try to automap folders ("Sent items", "Sent" =&gt; "Sent" etc.) (--automap)</label>
              </div>
            </div>
          </div>
          <div class="row mb-2">
            <div class="offset-sm-2 col-sm-10">
              <div class="form-check">
                <label><input type="checkbox" class="form-check-input" value="1" name="skipcrossduplicates"> Skip duplicate messages across folders (first come, first serve) (--skipcrossduplicates)</label>
              </div>
            </div>
          </div>
          <div class="row mb-2">
            <div class="offset-sm-2 col-sm-10">
              <div class="form-check">
                <label><input type="checkbox" class="form-check-input" value="1" name="subscribeall" checked=""> Subscribe all folders (--subscribeall)</label>
              </div>
            </div>
          </div>
          <div class="row mb-2">
            <div class="offset-sm-2 col-sm-10">
              <div class="form-check">
                <label><input type="checkbox" class="form-check-input" value="1" name="dry" checked=""> Simulate synchronization (--dry)</label>
              </div>
            </div>
          </div>
          <div class="row mb-4">
            <div class="offset-sm-2 col-sm-10">
              <div class="form-check">
                <label><input type="checkbox" class="form-check-input" value="1" name="active" checked=""> Active</label>
              </div>
            </div>
          </div>
          <div class="row mb-2">
            <div class="offset-sm-2 col-sm-10">
              <button class="btn btn-xs-lg d-block d-sm-inline btn-success" data-action="add_item" data-id="add_syncjob" data-api-url="add/syncjob" data-api-attr="{}" href="#">Add</button>
            </div>
          </div>
        <input type="hidden" value="a5e6f51085b6fcb8adc07084305e3956154d5683abdb5f23eb17f4a1dc5844df" name="csrf_token"></form>
      </div>
    </div>
  </div>
</div><!-- add sync job modal -->
<!-- app passwd modal -->
<div class="modal fade" id="addAppPasswdModal" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">Add app password</h3>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form class="form-horizontal" data-cached-form="true" role="form" data-pwgen-length="32" data-id="add_apppasswd">
          <div class="row mb-2">
            <label class="control-label col-sm-2" for="app_name">App name</label>
            <div class="col-sm-10">
              <input type="text" class="form-control" name="app_name" required="">
            </div>
          </div>
          <div class="row mb-4">
            <label class="control-label col-sm-2" for="app_passwd">Password (<a href="#" class="generate_password">generate</a>)</label>
            <div class="col-sm-10">
              <input type="password" data-pwgen-field="true" data-hibp="true" class="form-control" name="app_passwd" autocomplete="new-password" required=""><p class="small haveibeenpwned"><i class="bi bi-shield-fill-exclamation"></i> Check against haveibeenpwned.com</p><span class="hibp-out"></span><p class="help-block small">- Minimum password length is 6</p>
            </div>
          </div>
          <div class="row mb-2">
            <label class="control-label col-sm-2" for="app_passwd2">Password (repeat)</label>
            <div class="col-sm-10">
              <input type="password" data-pwgen-field="true" class="form-control" name="app_passwd2" autocomplete="new-password" required="">
              <p class="text-muted"></p>
            </div>
          </div>
          <div class="row mb-4">
            <label class="control-label col-sm-2" for="protocols">Allowed protocols for app password</label>
            <div class="col-sm-10">
              <div class="dropdown bootstrap-select show-tick full-width-select"><select class="full-width-select" data-live-search="true" id="protocols" name="protocols" multiple="">
                <option value="imap_access" selected="">IMAP</option>
                <option value="smtp_access" selected="">SMTP</option>
                <option value="eas_access" selected="">EAS/ActiveSync</option>
                <option value="dav_access" selected="">CardDAV/CalDAV</option>
                <option value="pop3_access" selected="">POP3</option>
                <option value="sieve_access" selected="">Sieve</option>
              </select><button type="button" tabindex="-1" class="btn btn-xs-lg dropdown-toggle btn-light" data-bs-toggle="dropdown" role="combobox" aria-owns="bs-select-4" aria-haspopup="listbox" aria-expanded="false" title="IMAP, SMTP, EAS/ActiveSync, CardDAV/CalDAV, POP3, Sieve" data-id="protocols"><div class="filter-option"><div class="filter-option-inner"><div class="filter-option-inner-inner">IMAP, SMTP, EAS/ActiveSync, CardDAV/CalDAV, POP3, Sieve</div></div> </div></button><div class="dropdown-menu "><div class="bs-searchbox"><input type="search" class="form-control" autocomplete="off" role="combobox" aria-label="Search" aria-controls="bs-select-4" aria-autocomplete="list"></div><div class="inner show" role="listbox" id="bs-select-4" tabindex="-1" aria-multiselectable="true"><ul class="dropdown-menu inner show" role="presentation"></ul></div></div></div>
            </div>
          </div>
          <div class="row mb-2">
            <div class="offset-sm-2 col-sm-10">
              <div class="form-check">
                <label><input type="checkbox" class="form-check-input" value="1" name="active" checked=""> Active</label>
              </div>
            </div>
          </div>
          <div class="row mb-2">
            <div class="offset-sm-2 col-sm-10">
              <button class="btn btn-xs-lg d-block d-sm-inline btn-success" data-action="add_item" data-id="add_apppasswd" data-api-url="add/app-passwd" data-api-attr="{}" href="#">Add</button>
            </div>
          </div>
        <input type="hidden" value="a5e6f51085b6fcb8adc07084305e3956154d5683abdb5f23eb17f4a1dc5844df" name="csrf_token"></form>
      </div>
    </div>
  </div>
</div><!-- add app passwd modal -->
<!-- log modal -->
<div class="modal fade" id="syncjobLogModal" tabindex="-1" role="dialog" aria-labelledby="syncjobLogModalLabel">
  <div class="modal-dialog modal-xl" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">Log</h3>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <div class="numberedtextarea-wrapper"><textarea class="form-control textarea-code" rows="20" id="logText" spellcheck="false" style="padding-left: 55.5px;"></textarea><div class="numberedtextarea-line-numbers" style="padding-left: 10.5px; padding-top: 5.25px; line-height: 21px; font-family: Consolas, Monaco, &quot;Lucida Console&quot;, &quot;Liberation Mono&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, monospace; width: 34.5px;"><div class="numberedtextarea-number numberedtextarea-number-1" style="margin-bottom: 5.25px;">1</div></div></div>
      </div>
    </div>
  </div>
</div><!-- log modal -->
<!-- pw change modal -->
<div class="modal fade" id="pwChangeModal" tabindex="-1" role="dialog" aria-labelledby="pwChangeModalLabel">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">Change password</h3>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form class="form-horizontal" data-cached-form="false" data-id="pwchange" role="form" method="post" autocomplete="off">
          <div class="row">
            <label class="control-label col-sm-3" for="user_new_pass">New password (<a href="#" class="generate_password">generate</a>)</label>
            <div class="col-sm-9">
              <input type="password" data-pwgen-field="true" data-hibp="true" class="form-control" name="user_new_pass" autocomplete="new-password" required=""><p class="small haveibeenpwned"><i class="bi bi-shield-fill-exclamation"></i> Check against haveibeenpwned.com</p><span class="hibp-out"></span><p class="help-block small">- Minimum password length is 6</p>
            </div>
          </div>
          <div class="row">
            <label class="control-label col-sm-3" for="user_new_pass2">Confirmation password (repeat)</label>
            <div class="col-sm-9">
              <input type="password" data-pwgen-field="true" class="form-control" name="user_new_pass2" autocomplete="new-password" required="">
              <p class="text-muted"></p>
            </div>
          </div>
          <hr>
          <div class="row mb-4">
            <label class="control-label col-sm-3" for="user_old_pass">Current password (confirm changes)</label>
            <div class="col-sm-9">
              <input type="password" class="form-control" name="user_old_pass" autocomplete="off" required="">
                          </div>
          </div>
          <div class="row">
            <div class="offset-sm-3 col-sm-9">
              <button class="btn btn-xs-lg d-block d-sm-inline btn-success" data-action="edit_selected" data-id="pwchange" data-item="null" data-api-url="edit/self" data-api-attr="{}" href="#">Change password</button>
            </div>
          </div>
        <input type="hidden" value="a5e6f51085b6fcb8adc07084305e3956154d5683abdb5f23eb17f4a1dc5844df" name="csrf_token"></form>
      </div>
    </div>
  </div>
</div><!-- pw change modal -->
<!-- pw recovery email modal -->
<div class="modal fade" id="pwRecoveryEmailModal" tabindex="-1" role="dialog" aria-labelledby="pwRecoveryEmailModalLabel">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">Password recovery email</h3>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form class="form-horizontal" data-cached-form="false" data-id="pw_recovery_change" role="form" method="post" autocomplete="off">
          <div class="row mb-4">
            <label class="control-label col-sm-3" for="pw_recovery_email">Email</label>
            <div class="col-sm-9">
              <input type="email" class="form-control" name="pw_recovery_email" value="">
              <small class="text-muted">If no email for password recovery is provided, this function cannot be used.</small>
            </div>
          </div>
          <div class="row mb-4">
            <label class="control-label col-sm-3" for="user_old_pass">Current password (confirm changes)</label>
            <div class="col-sm-9">
              <input type="password" class="form-control" name="user_old_pass" autocomplete="off" required="">
            </div>
          </div>
          <div class="row">
            <div class="offset-sm-3 col-sm-9">
              <button class="btn btn-xs-lg d-block d-sm-inline btn-success" data-action="edit_selected" data-id="pw_recovery_change" data-item="null" data-api-url="edit/self" data-api-attr="{}" href="#">Save changes</button>
            </div>
          </div>
        <input type="hidden" value="a5e6f51085b6fcb8adc07084305e3956154d5683abdb5f23eb17f4a1dc5844df" name="csrf_token"></form>
      </div>
    </div>
  </div>
</div><!-- pw recovery email modal -->
<!-- temp alias modal -->
<div class="modal fade" id="tempAliasModal" tabindex="-1" role="dialog" aria-labelledby="tempAliasModalLabel">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">Generate random alias</h3>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form class="form-horizontal" data-cached-form="false" data-id="tempaliascreate" role="form" method="post" autocomplete="off">
          <div class="row mb-4">
            <label class="control-label col-sm-3" for="description">Description</label>
            <div class="col-sm-5">
              <input type="hidden" id="temp_alias_domain" name="domain">
              <input type="description" id="temp_alias_description" class="form-control" name="description" autocomplete="off">
            </div>
          </div>
          <div class="row">
            <div class="offset-sm-3 col-sm-9">
              <button class="btn btn-xs-lg d-block d-sm-inline btn-success" data-action="add_item" data-id="tempaliascreate" data-item="null" data-api-url="add/time_limited_alias" data-api-attr="" href="#">Add</button>
            </div>
          </div>
        <input type="hidden" value="a5e6f51085b6fcb8adc07084305e3956154d5683abdb5f23eb17f4a1dc5844df" name="csrf_token"></form>
      </div>
    </div>
  </div>
</div><!-- temp alias modal -->
<!-- sieve filter modal -->
<div class="modal fade" id="userFilterModal" tabindex="-1" role="dialog">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">Active filter</h3>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <pre id="user_sieve_filter"></pre>
      </div>
    </div>
  </div>
</div><!-- sieve filter modal -->

<script type="text/javascript">
  var acl = '{"spam_alias":1,"tls_policy":1,"spam_score":1,"spam_policy":1,"delimiter_action":1,"syncjobs":0,"eas_reset":1,"sogo_profile_reset":0,"pushover":1,"quarantine":1,"quarantine_attachments":1,"quarantine_notification":1,"quarantine_category":1,"app_passwds":1,"pw_reset":0}';
  var lang = {"action":"Action","active":"Active","active_sieve":"Active filter","advanced_settings":"Advanced settings","alias":"Alias","alias_create_random":"Generate random alias","alias_extend_all":"Extend aliases by 1 hour","alias_full_date":"d.m.Y, H:i:s T","alias_remove_all":"Remove all aliases","alias_select_validity":"Period of validity","alias_time_left":"Time left","alias_valid_until":"Valid until","aliases_also_send_as":"Also allowed to send as user","aliases_send_as_all":"Do not check sender access for the following domain(s) and its alias domains","app_hint":"App passwords are alternative passwords for your IMAP, SMTP, CalDAV, CardDAV and EAS login. The username remains unchanged. SOGo webmail is not available through app passwords.","allowed_protocols":"Allowed protocols","app_name":"App name","app_passwds":"App passwords","apple_connection_profile":"Apple connection profile","apple_connection_profile_complete":"This connection profile includes IMAP and SMTP parameters as well as CalDAV (calendars) and CardDAV (contacts) paths for an Apple device.","apple_connection_profile_mailonly":"This connection profile includes IMAP and SMTP configuration parameters for an Apple device.","apple_connection_profile_with_app_password":"A new app password is generated and added to the profile so that no password needs to be entered when setting up your device. Please do not share the file as it grants full access to your mailbox.","attribute":"Attribute","authentication":"Authentication","change_password":"Change password","change_password_hint_app_passwords":"Your account has %d app passwords that will not be changed. To manage these, go to the App passwords tab.","clear_recent_successful_connections":"Clear seen successful connections","client_configuration":"Show configuration guides for email clients and smartphones","create_app_passwd":"Create app password","create_syncjob":"Create new sync job","created_on":"Created on","daily":"Daily","day":"day","description":"Description","delete_ays":"Please confirm the deletion process.","direct_aliases":"Direct alias addresses","direct_aliases_desc":"Direct alias addresses are affected by spam filter and TLS policy settings.","direct_protocol_access":"This mailbox user has <b>direct, external access<\/b> to the following protocols and applications. This setting is controlled by your administrator. App passwords can be created to grant access to individual protocols and applications.<br>The \"Webmail\" button provides single-sign-on to SOGo and is always available.","eas_reset":"Reset ActiveSync device cache","eas_reset_help":"In many cases a device cache reset will help to recover a broken ActiveSync profile.<br><b>Attention:<\/b> All elements will be redownloaded!","eas_reset_now":"Reset now","edit":"Edit","email":"Email","email_and_dav":"Email, calendars and contacts","empty":"No results","encryption":"Encryption","excludes":"Excludes","expire_in":"Expire in","expire_never":"Never Expire","fido2_webauthn":"FIDO2\/WebAuthn","forever":"Forever","force_pw_update":"You <b>must<\/b> set a new password to be able to access groupware related services.","from":"from","generate":"generate","hour":"hour","hourly":"Hourly","hours":"hours","in_use":"Used","interval":"Interval","is_catch_all":"Catch-all for domain\/s","last_mail_login":"Last mail login","last_pw_change":"Last password change","last_run":"Last run","last_ui_login":"Last UI login","loading":"Loading...","login_history":"Login history","mailbox":"Mailbox","mailbox_details":"Details","mailbox_general":"General","mailbox_settings":"Settings","messages":"messages","month":"month","months":"months","never":"Never","new_password":"New password","new_password_repeat":"Confirmation password (repeat)","no_active_filter":"No active filter available","no_last_login":"No last UI login information","no_record":"No record","open_logs":"Open logs","open_webmail_sso":"Webmail","overview":"Overview","password":"Password","password_now":"Current password (confirm changes)","password_repeat":"Password (repeat)","password_reset_info":"If no email for password recovery is provided, this function cannot be used.","protocols":"Protocols","pushover_evaluate_x_prio":"Escalate high priority mail [<code>X-Priority: 1<\/code>]","pushover_info":"Push notification settings will apply to all clean (non-spam) mail delivered to <b>%s<\/b> including aliases (shared, non-shared, tagged).","pushover_only_x_prio":"Only consider high priority mail [<code>X-Priority: 1<\/code>]","pushover_sender_array":"Consider the following sender email addresses <small>(comma-separated)<\/small>","pushover_sender_regex":"Match senders by the following regex","pushover_text":"Notification text","pushover_title":"Notification title","pushover_sound":"Sound","pushover_vars":"When no sender filter is defined, all mails will be considered.<br>Regex filters as well as exact sender checks can be defined individually and will be considered sequentially. They do not depend on each other.<br>Useable variables for text and title (please take note of data protection policies)","pushover_verify":"Verify credentials","pw_recovery_email":"Password recovery email","q_add_header":"Junk folder","q_all":"All categories","q_reject":"Rejected","quarantine_category":"Quarantine notification category","quarantine_category_info":"The notification category \"Rejected\" includes mail that was rejected, while \"Junk folder\" will notify a user about mails that were put into the junk folder.","quarantine_notification":"Quarantine notifications","quarantine_notification_info":"Once a notification has been sent, items will be marked as \"notified\" and no further notifications will be sent for this particular item.","recent_successful_connections":"Seen successful connections","remove":"Remove","running":"Running","save":"Save changes","save_changes":"Save changes","sender_acl_disabled":"<span class=\"badge fs-6 bg-danger\">Sender check is disabled<\/span>","shared_aliases":"Shared alias addresses","shared_aliases_desc":"Shared aliases are not affected by user specific settings such as the spam filter or encryption policy. Corresponding spam filters can only be made by an administrator as a domain-wide policy.","show_sieve_filters":"Show active user sieve filter","sogo_profile_reset":"Reset SOGo profile","sogo_profile_reset_help":"This will destroy a user's SOGo profile and <b>delete all contact and calendar data irretrievable<\/b>.","sogo_profile_reset_now":"Reset profile now","spam_aliases":"Spam email aliases","spam_aliases_info":"A spam alias is a temporary email address that can be used to protect real email addresses. <br>Optionally, an expiration time can be set so that the alias is automatically deactivated after the defined period, effectively disposing of abused or leaked addresses.","spam_score_reset":"Reset to server default","spamfilter":"Spam filter","spamfilter_behavior":"Rating","spamfilter_bl":"Denylist","spamfilter_bl_desc":"Denylisted email addresses to <b>always<\/b> classify as spam and reject. Rejected mail will <b>not<\/b> be copied to quarantine. Wildcards may be used. A filter is only applied to direct aliases (aliases with a single target mailbox) excluding catch-all aliases and a mailbox itself.","spamfilter_default_score":"Default values","spamfilter_green":"Green: this message is not spam","spamfilter_hint":"The first value describes the \"low spam score\", the second represents the \"high spam score\".","spamfilter_red":"Red: This message is spam and will be rejected by the server","spamfilter_table_action":"Action","spamfilter_table_add":"Add item","spamfilter_table_domain_policy":"n\/a (domain policy)","spamfilter_table_empty":"No data to display","spamfilter_table_remove":"remove","spamfilter_table_rule":"Rule","spamfilter_wl":"Allowlist","spamfilter_wl_desc":"Allowlisted email addresses are programmed to <b>never<\/b> classify as spam. Wildcards may be used. A filter is only applied to direct aliases (aliases with a single target mailbox) excluding catch-all aliases and a mailbox itself.","spamfilter_yellow":"Yellow: this message may be spam, will be tagged as spam and moved to your junk folder","status":"Status","sync_jobs":"Sync jobs","syncjob_check_log":"Check log","syncjob_last_run_result":"Last run result","syncjob_EX_OK":"Success","syncjob_EXIT_CONNECTION_FAILURE":"Connection problem","syncjob_EXIT_TLS_FAILURE":"Problem with encrypted connection","syncjob_EXIT_AUTHENTICATION_FAILURE":"Authentication problem","syncjob_EXIT_OVERQUOTA":"Target mailbox is over quota","syncjob_EXIT_CONNECTION_FAILURE_HOST1":"Can't connect to remote server","syncjob_EXIT_AUTHENTICATION_FAILURE_USER1":"Wrong username or password","tag_handling":"Set handling for tagged mail","tag_help_example":"Example for a tagged email address: me<b>+Facebook<\/b>@example.org","tag_help_explain":"In subfolder: a new subfolder named after the tag will be created below INBOX (\"INBOX\/Facebook\").<br>\r\nIn subject: the tags name will be prepended to the mails subject, example: \"[Facebook] My News\".","tag_in_none":"Do nothing","tag_in_subfolder":"In subfolder","tag_in_subject":"In subject","text":"Text","tfa_info":"Two-factor authentication helps protect your account. If you enable it, you need app passwords to log in to apps or services that don't support two-factor authentication (e.g. Mailclients).","title":"Title","tls_enforce_in":"Enforce TLS incoming","tls_enforce_out":"Enforce TLS outgoing","tls_policy":"Encryption policy","tls_policy_warning":"<strong>Warning:<\/strong> If you decide to enforce encrypted mail transfer, you may lose emails.<br>Messages to not satisfy the policy will be bounced with a hard fail by the mail system.<br>This option applies to your primary email address (login name), all addresses derived from alias domains as well as alias addresses <b>with only this single mailbox<\/b> as target.","user_settings":"User settings","username":"Username","value":"Value","verify":"Verify","waiting":"Waiting","week":"week","weekly":"Weekly","weeks":"weeks","with_app_password":"with app password","year":"year","years":"years"};
  var csrf_token = 'a5e6f51085b6fcb8adc07084305e3956154d5683abdb5f23eb17f4a1dc5844df';
  var pagination_size = Math.trunc('25');
  var mailcow_cc_username = 'hsd2loon9@cazehiresense.com';
  var user_spam_score = [8, 15];
  var lang_datatables = {"collapse_all":"Collapse All","decimal":".","emptyTable":"No data available in table","expand_all":"Expand All","info":"Showing _START_ to _END_ of _TOTAL_ entries","infoEmpty":"Showing 0 to 0 of 0 entries","infoFiltered":"(filtered from _MAX_ total entries)","infoPostFix":"","thousands":",","lengthMenu":"Show _MENU_ entries","loadingRecords":"Loading...","processing":"Please wait...","search":"Search:","zeroRecords":"No matching records found","paginate":{"first":"First","last":"Last","next":"Next","previous":"Previous"},"aria":{"sortAscending":": activate to sort column ascending","sortDescending":": activate to sort column descending"}};
</script>
</div>
  </div>

<div class="modal fade" id="YubiOTPModal" tabindex="-1" role="dialog" aria-labelledby="YubiOTPModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">Yubico OTP authentication</h3>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form role="form" method="post">
          <div class="mb-4">
            <input type="text" class="form-control" name="key_id" placeholder="An identifier for your Device" autocomplete="off" required="">
          </div>
          <hr>
          <p class="text-muted">mail.cazehiresense.com - mail UI uses the Yubico Cloud API. Please get an API key for your key <a href="https://upgrade.yubico.com/getapikey/" target="_blank">here</a></p>
          <div class="mb-2">
            <input type="text" class="form-control" name="yubico_id" placeholder="Yubico API ID" autocomplete="off" required="">
          </div>
          <div class="mb-4">
            <input type="text" class="form-control" name="yubico_key" placeholder="Yubico API Key" autocomplete="off" required="">
          </div>
          <hr>
          <div class="mb-4">
            <input type="password" class="form-control" name="confirm_password" placeholder="Current password (confirm changes)" autocomplete="off" required="">
          </div>
          <div class="mb-4">
            <div class="input-group">
              <span class="input-group-text" id="yubi-addon"><img alt="Yubicon Icon" src="/img/yubi.ico"></span>
              <input type="text" name="otp_token" class="form-control" placeholder="Touch Yubikey" aria-describedby="yubi-addon">
              <input type="hidden" name="tfa_method" value="yubi_otp">
            </div>
          </div>
          <button class="btn btn-sm d-block d-sm-inline btn-success" type="submit" name="set_tfa">Save changes</button>
        <input type="hidden" value="a5e6f51085b6fcb8adc07084305e3956154d5683abdb5f23eb17f4a1dc5844df" name="csrf_token"></form>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="WebAuthnModal" tabindex="-1" role="dialog" aria-labelledby="WebAuthnModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">WebAuthn authentication</h3>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form class="d-flex flex-column" role="form" method="post" id="webauthn_reg_form">
          <div class="mb-2">
            <input type="text" class="form-control" name="key_id" placeholder="An identifier for your Device" autocomplete="off" required="">
          </div>
          <div class="mb-4">
            <input type="password" class="form-control" name="confirm_password" placeholder="Current password (confirm changes)" autocomplete="off" required="">
          </div>
          <hr>
          <div class="text-center">
            <div style="cursor:pointer" id="start_webauthn_register">
              <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24">
                <path d="M17.81 4.47c-.08 0-.16-.02-.23-.06C15.66 3.42 14 3 12.01 3c-1.98 0-3.86.47-5.57 1.41-.24.13-.54.04-.68-.2-.13-.24-.04-.55.2-.68C7.82 2.52 9.86 2 12.01 2c2.13 0 3.99.47 6.03 1.52.25.13.34.43.21.67-.09.18-.26.28-.44.28zM3.5 9.72c-.1 0-.2-.03-.29-.09-.23-.16-.28-.47-.12-.7.99-1.4 2.25-2.5 3.75-3.27C9.98 4.04 14 4.03 17.15 5.65c1.5.77 2.76 1.86 3.75 3.25.16.22.11.54-.12.7-.23.16-.54.11-.7-.12-.9-1.26-2.04-2.25-3.39-2.94-2.87-1.47-6.54-1.47-9.4.01-1.36.7-2.5 1.7-3.4 2.96-.08.14-.23.21-.39.21zm6.25 12.07c-.13 0-.26-.05-.35-.15-.87-.87-1.34-1.43-2.01-2.64-.69-1.23-1.05-2.73-1.05-4.34 0-2.97 2.54-5.39 5.66-5.39s5.66 2.42 5.66 5.39c0 .28-.22.5-.5.5s-.5-.22-.5-.5c0-2.42-2.09-4.39-4.66-4.39-2.57 0-4.66 1.97-4.66 4.39 0 1.44.32 2.77.93 3.85.64 1.15 1.08 1.64 1.85 2.42.19.2.19.51 0 .71-.11.1-.24.15-.37.15zm7.17-1.85c-1.19 0-2.24-.3-3.1-.89-1.49-1.01-2.38-2.65-2.38-4.39 0-.28.22-.5.5-.5s.5.22.5.5c0 1.41.72 2.74 1.94 3.56.71.48 1.54.71 2.54.71.24 0 .64-.03 1.04-.1.27-.05.53.13.58.41.05.27-.13.53-.41.58-.57.11-1.07.12-1.21.12zM14.91 22c-.04 0-.09-.01-.13-.02-1.59-.44-2.63-1.03-3.72-2.1-1.4-1.39-2.17-3.24-2.17-5.22 0-1.62 1.38-2.94 3.08-2.94 1.7 0 3.08 1.32 3.08 2.94 0 1.07.93 1.94 2.08 1.94s2.08-.87 2.08-1.94c0-3.77-3.25-6.83-7.25-6.83-2.84 0-5.44 1.58-6.61 4.03-.39.81-.59 1.76-.59 2.8 0 .78.07 2.01.67 3.61.1.26-.03.55-.29.64-.26.1-.55-.04-.64-.29-.49-1.31-.73-2.61-.73-3.96 0-1.2.23-2.29.68-3.24 1.33-2.79 4.28-4.6 7.51-4.6 4.55 0 8.25 3.51 8.25 7.83 0 1.62-1.38 2.94-3.08 2.94s-3.08-1.32-3.08-2.94c0-1.07-.93-1.94-2.08-1.94s-2.08.87-2.08 1.94c0 1.71.66 3.31 1.87 4.51.95.94 1.86 1.46 3.27 1.85.27.07.42.35.35.61-.05.23-.26.38-.47.38z"></path>
              </svg>
              <p>Start validation</p>
            </div>
          </div>
          <hr>
          <p id="webauthn_status_reg"></p>
          <div class="alert alert-danger" style="display:none" id="webauthn_return_code"></div>
          <input type="hidden" name="token" id="webauthn_register_data">
          <input type="hidden" name="tfa_method" value="webauthn">
          <input type="hidden" name="set_tfa"><br>
        <input type="hidden" value="a5e6f51085b6fcb8adc07084305e3956154d5683abdb5f23eb17f4a1dc5844df" name="csrf_token"></form>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="TOTPModal" tabindex="-1" role="dialog" aria-labelledby="TOTPModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">Time-based OTP (Google Authenticator, Authy, etc.)</h3>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form role="form" method="post">
          <div class="mb-2">
            <input type="text" class="form-control" name="key_id" placeholder="An identifier for your key" autocomplete="off" required="">
          </div>
          <div class="mb-4">
            <input type="password" class="form-control" name="confirm_password" placeholder="Current password (confirm changes)" autocomplete="off" required="">
          </div>
          <hr>
          <input type="hidden" value="OHRNRGNMCG7KUABA" name="totp_secret">
          <input type="hidden" name="tfa_method" value="totp">
          <ol class="mb-4">
            <li>
              <p>Please scan the following code with your authenticator app or enter the code manually.</p>
              <img id="tfa-qr-img" data-totp-secret="OHRNRGNMCG7KUABA" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=">
              <p class="text-muted">Your TOTP code if your device cannot scan QR codes:<br>
                <code>OHRNRGNMCG7KUABA</code>
              </p>
            </li>
            <li>
              <p>Please confirm your changes by entering the generated token:</p>
              <p><input type="number" style="width:33%" class="form-control" name="totp_confirm_token" autocomplete="off" required=""></p>
              <p><button class="btn btn-sm d-block d-sm-inline btn-success" type="submit" name="set_tfa">Confirm</button></p>
            </li>
          </ol>
        <input type="hidden" value="a5e6f51085b6fcb8adc07084305e3956154d5683abdb5f23eb17f4a1dc5844df" name="csrf_token"></form>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="DisableTFAModal" tabindex="-1" role="dialog" aria-labelledby="DisableTFAModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">Disable TFA</h3>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form role="form" method="post">
          <div class="input-group">
            <input type="password" class="form-control" name="confirm_password" placeholder="Current password (confirm changes)" autocomplete="off" required="">
            <button class="btn btn-sm d-block d-sm-inline btn-danger" type="submit" name="set_tfa">Disable&nbsp;TFA</button>
          </div>
          <input type="hidden" name="tfa_method" value="none">
        <input type="hidden" value="a5e6f51085b6fcb8adc07084305e3956154d5683abdb5f23eb17f4a1dc5844df" name="csrf_token"></form>
      </div>
    </div>
  </div>
</div>
<div id="ConfirmDeleteModal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">Confirm deletion</h3>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <p id="DeleteText">Please confirm your changes to the following object id</p>
        <ul id="ItemsToDelete"></ul>
        <hr>
        <button class="btn btn-sm btn-xs-half d-block d-sm-inline btn-danger" id="IsConfirmed">Delete now</button>
        <button class="btn btn-sm btn-xs-half d-block d-sm-inline btn-secondary" id="isCanceled">Cancel</button>
      </div>
    </div>
  </div>
</div>
<!-- version modal -->
<div class="modal fade" id="showVersionModal" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title"></h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body d-flex flex-column mt-2 p-4">
        <div class="spinner-border mx-auto" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
      </div>
    </div>
  </div>
</div><!-- version modal -->

<script src="/cache/db7941ab83dbbf5fa67743b9707f6019269139dc.js"></script>
<script>
  var lang_footer = {"cancel":"Cancel","confirm_delete":"Confirm deletion","delete_now":"Delete now","delete_these_items":"Please confirm your changes to the following object id","hibp_check":"Check against haveibeenpwned.com","hibp_nok":"Matched! This is a potentially dangerous password!","hibp_ok":"No match found.","loading":"Please wait...","nothing_selected":"Nothing selected","restart_container":"Restart container","restart_container_info":"<b>Important:<\/b> A graceful restart may take a while to complete, please wait for it to finish.","restart_now":"Restart now","restarting_container":"Restarting container, this may take a while"};
  var lang_acl = {"alias_domains":"Add alias domains","app_passwds":"Manage app passwords","bcc_maps":"BCC maps","delimiter_action":"Delimiter action","domain_desc":"Change domain description","domain_relayhost":"Change relayhost for a domain","eas_reset":"Reset EAS devices","extend_sender_acl":"Allow to extend sender ACL by external addresses","filters":"Filters","login_as":"Login as mailbox user","mailbox_relayhost":"Change relayhost for a mailbox","prohibited":"Prohibited by ACL","protocol_access":"Change protocol access","pushover":"Pushover","pw_reset":"Allow to reset mailcow user password","quarantine":"Quarantine actions","quarantine_attachments":"Quarantine attachments","quarantine_category":"Change quarantine notification category","quarantine_notification":"Change quarantine notifications","ratelimit":"Rate limit","recipient_maps":"Recipient maps","smtp_ip_access":"Change allowed hosts for SMTP","sogo_access":"Allow management of SOGo access","sogo_profile_reset":"Reset SOGo profile","spam_alias":"Temporary aliases","spam_policy":"Denylist\/Allowlist","spam_score":"Spam score","syncjobs":"Sync jobs","tls_policy":"TLS policy","unlimited_quota":"Unlimited quota for mailboxes"};
  var lang_tfa = {"authenticators":"Authenticators","api_register":"%s uses the Yubico Cloud API. Please get an API key for your key <a href=\"https:\/\/upgrade.yubico.com\/getapikey\/\" target=\"_blank\">here<\/a>","confirm":"Confirm","confirm_totp_token":"Please confirm your changes by entering the generated token","delete_tfa":"Disable TFA","disable_tfa":"Disable TFA until next successful login","enter_qr_code":"Your TOTP code if your device cannot scan QR codes","error_code":"Error code","init_webauthn":"Initializing, please wait...","key_id":"An identifier for your Device","key_id_totp":"An identifier for your key","none":"Deactivate","reload_retry":"- (reload browser if the error persists)","scan_qr_code":"Please scan the following code with your authenticator app or enter the code manually.","select":"Please select","set_tfa":"Set two-factor authentication method","start_webauthn_validation":"Start validation","tfa":"Two-factor authentication","tfa_token_invalid":"TFA token invalid","totp":"Time-based OTP (Google Authenticator, Authy, etc.)","u2f_deprecated":"It seems that your Key was registered using the deprecated U2F method. We will deactivate Two-Factor-Authenticaiton for you and delete your Key.","u2f_deprecated_important":"Please register your Key in the admin panel with the new WebAuthn method.","webauthn":"WebAuthn authentication","waiting_usb_auth":"<i>Waiting for USB device...<\/i><br><br>Please tap the button on your USB device now.","waiting_usb_register":"<i>Waiting for USB device...<\/i><br><br>Please enter your password above and confirm your registration by tapping the button on your USB device.","yubi_otp":"Yubico OTP authentication"};
  var lang_fido2 = {"confirm":"Confirm","fido2_auth":"Login with FIDO2","fido2_success":"Device successfully registered","fido2_validation_failed":"Validation failed","fn":"Friendly name","known_ids":"Known IDs","none":"Disabled","register_status":"Registration status","rename":"Rename","set_fido2":"Register FIDO2 device","set_fido2_touchid":"Register Touch ID on Apple M1","set_fn":"Set friendly name","start_fido2_validation":"Start FIDO2 validation"};
  var lang_success = {"acl_saved":"ACL for object %s saved","admin_added":"Administrator %s has been added","admin_api_modified":"Changes to API have been saved","admin_modified":"Changes to administrator have been saved","admin_removed":"Administrator %s has been removed","alias_added":"Alias address %s (%d) has been added","alias_domain_removed":"Alias domain %s has been removed","alias_modified":"Changes to alias address %s have been saved","alias_removed":"Alias %s has been removed","aliasd_added":"Added alias domain %s","aliasd_modified":"Changes to alias domain %s have been saved","app_links":"Saved changes to app links","app_passwd_added":"Added new app password","app_passwd_removed":"Removed app password ID %s","bcc_deleted":"BCC map entries deleted: %s","bcc_edited":"BCC map entry %s edited","bcc_saved":"BCC map entry saved","cors_headers_edited":"CORS settings have been saved","custom_login_modified":"Login customisation was saved successfully","db_init_complete":"Database initialization completed","delete_filter":"Deleted filters ID %s","delete_filters":"Deleted filters: %s","deleted_syncjob":"Deleted syncjob ID %s","deleted_syncjobs":"Deleted syncjobs: %s","dkim_added":"DKIM key %s has been saved","domain_add_dkim_available":"A DKIM key did already exist","dkim_duplicated":"DKIM key for domain %s has been copied to %s","dkim_removed":"DKIM key %s has been removed","domain_added":"Added domain %s","domain_admin_added":"Domain administrator %s has been added","domain_admin_modified":"Changes to domain administrator %s have been saved","domain_admin_removed":"Domain administrator %s has been removed","domain_footer_modified":"Changes to domain footer %s have been saved","domain_modified":"Changes to domain %s have been saved","domain_removed":"Domain %s has been removed","dovecot_restart_success":"Dovecot was restarted successfully","eas_reset":"ActiveSync devices for user %s were reset","f2b_banlist_refreshed":"Banlist ID has been successfully refreshed.","f2b_modified":"Changes to Fail2ban parameters have been saved","forwarding_host_added":"Forwarding host %s has been added","forwarding_host_removed":"Forwarding host %s has been removed","global_filter_written":"Filter was successfully written to file","hash_deleted":"Hash deleted","iam_test_connection":"Connection successful","ip_check_opt_in_modified":"IP check was saved successfully","item_deleted":"Item %s successfully deleted","item_released":"Item %s released","items_deleted":"Item %s successfully deleted","items_released":"Selected items were released","learned_ham":"Successfully learned ID %s as ham","license_modified":"Changes to license have been saved","logged_in_as":"Logged in as %s","mailbox_added":"Mailbox %s has been added","mailbox_modified":"Changes to mailbox %s have been saved","mailbox_removed":"Mailbox %s has been removed","mailbox_renamed":"Mailbox was renamed from %s to %s","nginx_reloaded":"Nginx was reloaded","object_modified":"Changes to object %s have been saved","password_policy_saved":"Password policy was saved successfully","password_changed_success":"Password was successfully changed","pushover_settings_edited":"Pushover settings successfully set, please verify credentials.","qlearn_spam":"Message ID %s was learned as spam and deleted","queue_command_success":"Queue command completed successfully","recipient_map_entry_deleted":"Recipient map ID %s has been deleted","recipient_map_entry_saved":"Recipient map entry \"%s\" has been saved","recovery_email_sent":"Recovery email sent to %s","relayhost_added":"Map entry %s has been added","relayhost_removed":"Map entry %s has been removed","reset_main_logo":"Reset to default logo","resource_added":"Resource %s has been added","resource_modified":"Changes to mailbox %s have been saved","resource_removed":"Resource %s has been removed","rl_saved":"Rate limit for object %s saved","rspamd_ui_pw_set":"Rspamd UI password successfully set","saved_settings":"Saved settings","settings_map_added":"Added settings map entry","settings_map_removed":"Removed settings map ID %s","sogo_profile_reset":"SOGo profile for user %s was reset","template_added":"Added template %s","template_modified":"Changes to template %s have been saved","template_removed":"Template ID %s has been deleted","tls_policy_map_entry_deleted":"TLS policy map ID %s has been deleted","tls_policy_map_entry_saved":"TLS policy map entry \"%s\" has been saved","ui_texts":"Saved changes to UI texts","upload_success":"File uploaded successfully","verified_fido2_login":"Verified FIDO2 login","verified_totp_login":"Verified TOTP login","verified_webauthn_login":"Verified WebAuthn login","verified_yotp_login":"Verified Yubico OTP login"};
  var lang_danger = {"access_denied":"Access denied or invalid form data","alias_domain_invalid":"Alias domain %s is invalid","alias_empty":"Alias address must not be empty","alias_goto_identical":"Alias and goto address must not be identical","alias_invalid":"Alias address %s is invalid","aliasd_targetd_identical":"Alias domain must not be equal to target domain: %s","aliases_in_use":"Max. aliases must be greater or equal to %d","app_name_empty":"App name cannot be empty","app_passwd_id_invalid":"App password ID %s invalid","authsource_in_use":"The identity provider cannot be changed or deleted as it is currently in use by one or more users.","bcc_empty":"BCC destination cannot be empty","bcc_exists":"A BCC map %s exists for type %s","bcc_must_be_email":"BCC destination %s is not a valid email address","comment_too_long":"Comment too long, max 160 chars allowed","cors_invalid_method":"Invalid Allow-Method specified","cors_invalid_origin":"Invalid Allow-Origin specified","defquota_empty":"Default quota per mailbox must not be 0.","demo_mode_enabled":"Demo Mode is enabled","description_invalid":"Resource description for %s is invalid","dkim_domain_or_sel_exists":"A DKIM key for \"%s\" exists and will not be overwritten","dkim_domain_or_sel_invalid":"DKIM domain or selector invalid: %s","domain_cannot_match_hostname":"Domain cannot match hostname","domain_exists":"Domain %s already exists","domain_invalid":"Domain name is empty or invalid","domain_not_empty":"Cannot remove non-empty domain %s","domain_not_found":"Domain %s not found","domain_quota_m_in_use":"Domain quota must be greater or equal to %s MiB","extended_sender_acl_denied":"missing ACL to set external sender addresses","extra_acl_invalid":"External sender address \"%s\" is invalid","extra_acl_invalid_domain":"External sender \"%s\" uses an invalid domain","fido2_verification_failed":"FIDO2 verification failed: %s","file_open_error":"File cannot be opened for writing","filter_type":"Wrong filter type","from_invalid":"Sender must not be empty","generic_server_error":"An unexpected server error occurred. Please contact your administrator.","global_filter_write_error":"Could not write filter file: %s","global_map_invalid":"Global map ID %s invalid","global_map_write_error":"Could not write global map ID %s: %s","goto_empty":"An alias address must contain at least one valid goto address","goto_invalid":"Goto address %s is invalid","ham_learn_error":"Ham learn error: %s","iam_test_connection":"Connection failed","imagick_exception":"Error: Imagick exception while reading image","img_dimensions_exceeded":"Image exceeds the maximum image size","img_invalid":"Cannot validate image file","img_size_exceeded":"Image exceeds the maximum file size","img_tmp_missing":"Cannot validate image file: Temporary file not found","invalid_bcc_map_type":"Invalid BCC map type","invalid_destination":"Destination format \"%s\" is invalid","invalid_filter_type":"Invalid filter type","invalid_host":"Invalid host specified: %s","invalid_mime_type":"Invalid mime type","invalid_nexthop":"Next hop format is invalid","invalid_nexthop_authenticated":"Next hop exists with different credentials, please update the existing credentials for this next hop first.","invalid_recipient_map_new":"Invalid new recipient specified: %s","invalid_recipient_map_old":"Invalid original recipient specified: %s","invalid_reset_token":"Invalid reset token","ip_list_empty":"List of allowed IPs cannot be empty","is_alias":"%s is already known as an alias address","is_alias_or_mailbox":"%s is already known as an alias, a mailbox or an alias address expanded from an alias domain.","is_spam_alias":"%s is already known as a temporary alias address (spam alias address)","last_key":"Last key cannot be deleted, please deactivate TFA instead.","login_failed":"Login failed","mailbox_defquota_exceeds_mailbox_maxquota":"Default quota exceeds max quota limit","mailbox_invalid":"Mailbox name is invalid","mailbox_quota_exceeded":"Quota exceeds the domain limit (max. %d MiB)","mailbox_quota_exceeds_domain_quota":"Max. quota exceeds domain quota limit","mailbox_quota_left_exceeded":"Not enough space left (space left: %d MiB)","mailboxes_in_use":"Max. mailboxes must be greater or equal to %d","malformed_username":"Malformed username","map_content_empty":"Map content cannot be empty","max_age_invalid":"Max age %s is invalid","max_alias_exceeded":"Max. aliases exceeded","max_mailbox_exceeded":"Max. mailboxes exceeded (%d of %d)","max_quota_in_use":"Mailbox quota must be greater or equal to %d MiB","maxquota_empty":"Max. quota per mailbox must not be 0.","mode_invalid":"Mode %s is invalid","mx_invalid":"MX record %s is invalid","mysql_error":"MySQL error: %s","network_host_invalid":"Invalid network or host: %s","next_hop_interferes":"%s interferes with nexthop %s","next_hop_interferes_any":"An existing next hop interferes with %s","nginx_reload_failed":"Nginx reload failed: %s","no_user_defined":"No user defined","object_exists":"Object %s already exists","object_is_not_numeric":"Value %s is not numeric","password_complexity":"Password does not meet the policy","password_empty":"Password must not be empty","password_mismatch":"Confirmation password does not match","password_reset_invalid_user":"Mailbox not found or no recovery email is set","password_reset_na":"The password recovery is currently unavailable. Please contact your administrator.","policy_list_from_exists":"A record with given name exists","policy_list_from_invalid":"Record has invalid format","private_key_error":"Private key error: %s","pushover_credentials_missing":"Pushover token and or key missing","pushover_key":"Pushover key has a wrong format","pushover_token":"Pushover token has a wrong format","quota_not_0_not_numeric":"Quota must be numeric and >= 0","recipient_map_entry_exists":"A Recipient map entry \"%s\" exists","recovery_email_failed":"Could not send a recovery email. Please contact your administrator.","redis_error":"Redis error: %s","relayhost_invalid":"Map entry %s is invalid","release_send_failed":"Message could not be released: %s","required_data_missing":"Required data %s is missing","reset_f2b_regex":"Regex filter could not be reset in time, please try again or wait a few more seconds and reload the website.","reset_token_limit_exceeded":"Reset token limit has been exceeded. Please try again later.","resource_invalid":"Resource name %s is invalid","rl_timeframe":"Rate limit time frame is incorrect","rspamd_ui_pw_length":"Rspamd UI password should be at least 6 chars long","script_empty":"Script cannot be empty","sender_acl_invalid":"Sender ACL value %s is invalid","set_acl_failed":"Failed to set ACL","settings_map_invalid":"Settings map ID %s invalid","sieve_error":"Sieve parser error: %s","spam_learn_error":"Spam learn error: %s","subject_empty":"Subject must not be empty","target_domain_invalid":"Target domain %s is invalid","targetd_not_found":"Target domain %s not found","targetd_relay_domain":"Target domain %s is a relay domain","template_exists":"Template %s already exists","template_id_invalid":"Template ID %s invalid","template_name_invalid":"Template name invalid","temp_error":"Temporary error","text_empty":"Text must not be empty","tfa_token_invalid":"TFA token invalid","tls_policy_map_dest_invalid":"Policy destination is invalid","tls_policy_map_entry_exists":"A TLS policy map entry \"%s\" exists","tls_policy_map_parameter_invalid":"Policy parameter is invalid","to_invalid":"Recipient must not be empty","totp_verification_failed":"TOTP verification failed","transport_dest_exists":"Transport destination \"%s\" exists","webauthn_verification_failed":"WebAuthn verification failed: %s","webauthn_authenticator_failed":"The selected authenticator was not found","webauthn_publickey_failed":"No public key was stored for the selected authenticator","webauthn_username_failed":"The selected authenticator belongs to another account","unknown":"An unknown error occurred","unknown_tfa_method":"Unknown TFA method","unlimited_quota_acl":"Unlimited quota prohibited by ACL","username_invalid":"Username %s cannot be used","validity_missing":"Please assign a period of validity","value_missing":"Please provide all values","version_invalid":"Version %s is invalid","yotp_verification_failed":"Yubico OTP verification failed: %s"};
  var docker_timeout = 60 * 1000;
  var mailcow_cc_role = 'user';
    var mailcow_info = {
    version_tag: '2025-12a',
    last_version_tag: '',
    updatedAt: '1769619148',
    project_url: 'https://github.com/mailcow/mailcow-dockerized',
    project_owner: 'mailcow',
    project_repo: 'mailcow-dockerized',
    branch: 'master'
  };
  
$(window).scroll(function() {
  sessionStorage.scrollTop = $(this).scrollTop();
});
// Select language and reopen active URL without POST
function setLang(sel) {
  $.post( '/user', {lang: sel} );
  window.location.href = window.location.pathname + window.location.search;
}
// FIDO2 functions
function arrayBufferToBase64(buffer) {
  let binary = '';
  let bytes = new Uint8Array(buffer);
  let len = bytes.byteLength;
  for (let i = 0; i < len; i++) {
    binary += String.fromCharCode( bytes[ i ] );
  }
  return window.btoa(binary);
}
function recursiveBase64StrToArrayBuffer(obj) {
  let prefix = '=?BINARY?B?';
  let suffix = '?=';
  if (typeof obj === 'object') {
    for (let key in obj) {
      if (typeof obj[key] === 'string') {
        let str = obj[key];
        if (str.substring(0, prefix.length) === prefix && str.substring(str.length - suffix.length) === suffix) {
          str = str.substring(prefix.length, str.length - suffix.length);
          let binary_string = window.atob(str);
          let len = binary_string.length;
          let bytes = new Uint8Array(len);
          for (let i = 0; i < len; i++) {
            bytes[i] = binary_string.charCodeAt(i);
          }
          obj[key] = bytes.buffer;
        }
      } else {
        recursiveBase64StrToArrayBuffer(obj[key]);
      }
    }
  }
}
  $(window).on('load', function() {
    $(".overlay").hide();
  });
  $(document).ready(function() {
    $(document).on('shown.bs.modal', function(e) {
      modal_id = $(e.relatedTarget).data('target');
      $(modal_id).attr("aria-hidden","false");
    });
    // TFA, CSRF, Alerts in footer.inc.php
    // Other general functions in mailcow.js
        mailcow_alert_box('Logged\u0020in\u0020as\u0020hsd2loon9\u0040cazehiresense.com', 'success');
    
    // Confirm TFA modal
  

    // Validate FIDO2
  $("#fido2-login").click(function(){
    $('#fido2-alerts').html();
    if (!window.fetch || !navigator.credentials || !navigator.credentials.create) {
      window.alert('Browser not supported.');
      return;
    }
    window.fetch("/api/v1/get/fido2-get-args", {method:'GET',cache:'no-cache'}).then(function(response) {
      return response.json();
    }).then(function(json) {
    if (json.success === false) {
      throw new Error();
    }
    recursiveBase64StrToArrayBuffer(json);
    return json;
    }).then(function(getCredentialArgs) {
      return navigator.credentials.get(getCredentialArgs);
    }).then(function(cred) {
      return {
        id: cred.rawId ? arrayBufferToBase64(cred.rawId) : null,
        clientDataJSON: cred.response.clientDataJSON  ? arrayBufferToBase64(cred.response.clientDataJSON) : null,
        authenticatorData: cred.response.authenticatorData ? arrayBufferToBase64(cred.response.authenticatorData) : null,
        signature : cred.response.signature ? arrayBufferToBase64(cred.response.signature) : null
      };
    }).then(JSON.stringify).then(function(AuthenticatorAttestationResponse) {
      var formData = new FormData();
      formData.append("token", AuthenticatorAttestationResponse);
      formData.append("verify_fido2_login", "true");

      return window.fetch(window.location.href, {method:'POST', body: formData, cache:'no-cache'});
    }).then(function(response) {
      window.location = window.location.href.split("#")[0];
    }).catch(function(err) {
    if (typeof err.message === 'undefined') {
      mailcow_alert_box(lang_fido2.fido2_validation_failed, "danger");
    } else {
      mailcow_alert_box(lang_fido2.fido2_validation_failed + ":<br><i>" + err.message + "</i>", "danger");
    }
  });
  });
  // Set TFA/FIDO2
  $("#register-fido2, #register-fido2-touchid").click(function(){
    let t = $(this);

    $("option:selected").prop("selected", false);
    if (!window.fetch || !navigator.credentials || !navigator.credentials.create) {
      window.alert('Browser not supported.');
      return;
    }

    window.fetch("/api/v1/get/fido2-registration/hsd2loon9%40cazehiresense.com", {method:'GET',cache:'no-cache'}).then(function(response) {
      return response.json();
    }).then(function(json) {
      if (json.success === false) {
        throw new Error(json.msg);
      }
      recursiveBase64StrToArrayBuffer(json);

      // set attestation to node if we are registering apple touch id
      if(t.attr('id') === 'register-fido2-touchid') {
        json.publicKey.attestation = 'none';
        json.publicKey.authenticatorSelection.authenticatorAttachment = "platform";
      }

      return json;
    }).then(function(createCredentialArgs) {
      console.log(createCredentialArgs);
      return navigator.credentials.create(createCredentialArgs);
    }).then(function(cred) {
      return {
        clientDataJSON: cred.response.clientDataJSON  ? arrayBufferToBase64(cred.response.clientDataJSON) : null,
        attestationObject: cred.response.attestationObject ? arrayBufferToBase64(cred.response.attestationObject) : null
      };
    }).then(JSON.stringify).then(function(AuthenticatorAttestationResponse) {
      return window.fetch("/api/v1/add/fido2-registration", {method:'POST', body: AuthenticatorAttestationResponse, cache:'no-cache'});
    }).then(function(response) {
      return response.json();
    }).then(function(json) {
      if (json.success) {
        window.location = window.location.href.split("#")[0];
      } else {
        throw new Error(json.msg);
      }
    }).catch(function(err) {
      $('#fido2-alerts').html('<span class="text-danger"><b>' + err.message + '</b></span>');
    });
  });
  $('#selectTFA').change(function () {
    if ($(this).val() == "yubi_otp") {
      $('#YubiOTPModal').modal('show');
      $("option:selected").prop("selected", false);
    }
    if ($(this).val() == "totp") {
      $('#TOTPModal').modal('show');
      request_token = $('#tfa-qr-img').data('totp-secret');
      $.ajax({
        url: '/inc/ajax/qr_gen.php',
        data: {
          token: request_token,
        },
      }).done(function (result) {
        $("#tfa-qr-img").attr("src", result);
      });
      $("option:selected").prop("selected", false);
    }
    if ($(this).val() == "webauthn") {
        // check if Browser is supported
        if (!window.fetch || !navigator.credentials || !navigator.credentials.create) {
            window.alert('Browser not supported.');
            return;
        }

        // show modal
        $('#WebAuthnModal').modal('show');
        $("option:selected").prop("selected", false);

        $("#start_webauthn_register").click(() => {
            var key_id = document.getElementsByName('key_id')[1].value;
            var confirm_password = document.getElementsByName('confirm_password')[1].value;

            // fetch WebAuthn create args
            window.fetch("/api/v1/get/webauthn-tfa-registration/hsd2loon9%40cazehiresense.com", {method:'GET',cache:'no-cache'}).then(response => {
                return response.json();
            }).then(json => {
                console.log(json);
                if (json.success === false) throw new Error(json.msg);
                recursiveBase64StrToArrayBuffer(json);

                return json;
            }).then(createCredentialArgs => {
                // create credentials
                return navigator.credentials.create(createCredentialArgs);
            }).then(cred => {
                return {
                    clientDataJSON: cred.response.clientDataJSON  ? arrayBufferToBase64(cred.response.clientDataJSON) : null,
                    attestationObject: cred.response.attestationObject ? arrayBufferToBase64(cred.response.attestationObject) : null,
                    key_id: key_id,
                    tfa_method: "webauthn",
                    confirm_password: confirm_password
                };
            }).then(JSON.stringify).then(AuthenticatorAttestationResponse => {
                // send request
                return window.fetch("/api/v1/add/webauthn-tfa-registration", {method:'POST', body: AuthenticatorAttestationResponse, cache:'no-cache'});
            }).then(response => {
                return response.json();
            }).then(json => {
                if (json.success) {
                    // reload on success
                    window.location = window.location.href.split("#")[0];
                } else {
                    throw new Error(json.msg);
                }
            }).catch(function(err) {
                console.log(err);
                var webauthn_return_code = document.getElementById('webauthn_return_code');
                webauthn_return_code.style.display = webauthn_return_code.style.display === 'none' ? '' : null;
                webauthn_return_code.innerHTML = lang_tfa.error_code + ': ' + err + ' ' + lang_tfa.reload_retry;
            });
        });
    }
    if ($(this).val() == "none") {
      $('#DisableTFAModal').modal('show');
      $("option:selected").prop("selected", false);
    }
  });

    // Reload after session timeout
  var session_lifetime = 10815000;
  setTimeout(function() {
    location.reload();
  }, session_lifetime);
  
  // CSRF
  $('<input type="hidden" value="a5e6f51085b6fcb8adc07084305e3956154d5683abdb5f23eb17f4a1dc5844df">').attr('name', 'csrf_token').appendTo('form');
  if (sessionStorage.scrollTop != "undefined") {
    $(window).scrollTop(sessionStorage.scrollTop);
  }
  });
</script>

<div class="container footer">
      <span class="version">
    🐮 + 🐋 = 💕
        Version: <a href="https://github.com/mailcow/mailcow-dockerized/releases/tag/2025-12a" target="_blank">2025-12a
    </a>
  </span>
      </div>


<div data-notify="container" class="col-xs-11 col-sm-4 alert alert-success animated fadeInUp" role="alert" data-notify-position="bottom-right" style="display: inline-block; margin: 0px auto; position: fixed; transition: 0.5s ease-in-out; z-index: 20000; bottom: 20px; right: 20px;"><button type="button" aria-hidden="true" class="btn-close" data-notify="dismiss" style="position: absolute; right: 10px; top: 5px; z-index: 20002;"></button><span data-notify="icon"></span> <span data-notify="title"></span> <span data-notify="message">Logged in as hsd2loon9@cazehiresense.com</span><a href="#" target="_blank" data-notify="url"></a></div></body></html>